(()=>{var e={};e.id=7936,e.ids=[7936],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},9312:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>p,serverHooks:()=>w,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{DELETE:()=>c,GET:()=>d,POST:()=>u});var a=r(5122),o=r(7868),i=r(9769),n=r(1929),l=r(6427);async function d(e){try{let{searchParams:t}=new URL(e.url),r=t.get("feature"),s=t.get("galleryItemId"),a=t.get("userId");if("comments"===r&&s){let e=l.G_.filter(e=>e.galleryItemId===s);return n.NextResponse.json({comments:e})}if("votes"===r&&s&&a){let e=l.Tn.find(e=>e.galleryItemId===s&&e.userId===a);return n.NextResponse.json({vote:e||null})}if("favorites"===r&&a){if(s){let e=l.lB.some(e=>e.galleryItemId===s&&e.userId===a);return n.NextResponse.json({isFavorited:e})}{let e=l.lB.filter(e=>e.userId===a);return n.NextResponse.json({favorites:e})}}if("search-history"===r&&a){let e=l.gq.filter(e=>e.userId===a).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,10);return n.NextResponse.json({searchHistory:e})}let o=parseInt(t.get("page")||"1"),i=parseInt(t.get("limit")||"12"),d=t.get("sortBy")||"createdAt",u=t.get("sortOrder")||"desc",c=t.get("search")||"",p=t.get("dateFilter")||"",m=t.get("dateRangeEnd")||"",g=l.rk;if(c){let e=c.toLowerCase();g=l.rk.filter(t=>t.title.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.uploader.toLowerCase().includes(e)||t.tags.some(t=>t.toLowerCase().includes(e)))}(p||m)&&(g=g.filter(e=>{let t=new Date(e.createdAt);if(p&&m){let e=new Date(p),r=new Date(m);return r.setHours(23,59,59,999),t>=e&&t<=r}if(p){let e=new Date(p),r=new Date(e);return r.setDate(r.getDate()+1),t>=e&&t<r}return!0})),g.sort((e,t)=>{let r,s;switch(d){case"createdAt":default:r=new Date(e.createdAt),s=new Date(t.createdAt);break;case"title":r=e.title.toLowerCase(),s=t.title.toLowerCase();break;case"uploader":r=e.uploader.toLowerCase(),s=t.uploader.toLowerCase();break;case"upvotes":r=e.upvotes,s=t.upvotes;break;case"viewCount":r=e.viewCount,s=t.viewCount}return"asc"===u?r>s?1:-1:r<s?1:-1});let w=g.length,h=Math.ceil(w/i),f=(o-1)*i,v=g.slice(f,f+i);return n.NextResponse.json({items:v,pagination:{currentPage:o,totalPages:h,totalItems:w,itemsPerPage:i,hasNextPage:o<h,hasPrevPage:o>1},filters:{search:c,sortBy:d,sortOrder:u,dateFilter:p,dateRangeEnd:m}})}catch(e){return console.error("Gallery GET error:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}async function u(e){try{let{searchParams:t}=new URL(e.url),r=t.get("feature");if("vote"===r){let{galleryItemId:t,userId:r,voteType:s}=await e.json();if(!t||!r||!s)return n.NextResponse.json({error:"Missing required fields"},{status:400});let a=l.Tn.findIndex(e=>e.galleryItemId===t&&e.userId===r);if(-1!==a){let e=l.Tn[a];l.Tn.splice(a,1);let r=l.rk.find(e=>e.id===t);if(r&&("upvote"===e.voteType?r.upvotes=Math.max(0,r.upvotes-1):r.downvotes=Math.max(0,r.downvotes-1)),e.voteType===s)return n.NextResponse.json({success:!0,vote:null})}let o={id:Date.now().toString(),galleryItemId:t,userId:r,voteType:s,createdAt:new Date().toISOString()};l.Tn.push(o);let i=l.rk.find(e=>e.id===t);return i&&("upvote"===s?i.upvotes++:i.downvotes++),n.NextResponse.json({success:!0,vote:o})}if("favorite"===r){let{galleryItemId:t,userId:r}=await e.json();if(!t||!r)return n.NextResponse.json({error:"Missing required fields"},{status:400});let s=l.lB.findIndex(e=>e.galleryItemId===t&&e.userId===r);if(-1!==s)return l.lB.splice(s,1),n.NextResponse.json({success:!0,isFavorited:!1});{let e={id:Date.now().toString(),galleryItemId:t,userId:r,createdAt:new Date().toISOString()};return l.lB.push(e),n.NextResponse.json({success:!0,isFavorited:!0})}}if("comment"===r){let{galleryItemId:t,userId:r,userName:s,content:a}=await e.json();if(!t||!r||!s||!a?.trim())return n.NextResponse.json({error:"Missing required fields"},{status:400});let o={id:Date.now().toString(),galleryItemId:t,userId:r,userName:s,content:a.trim(),createdAt:new Date().toISOString()};return l.G_.push(o),n.NextResponse.json({success:!0,comment:o})}if("search-history"===r){let{userId:t,searchTerm:r}=await e.json();if(!t||!r?.trim())return n.NextResponse.json({error:"Missing required fields"},{status:400});let s=l.gq.findIndex(e=>e.userId===t&&e.searchTerm===r.trim());-1!==s&&l.gq.splice(s,1);let a={id:Date.now().toString(),userId:t,searchTerm:r.trim(),createdAt:new Date().toISOString()};l.gq.unshift(a);let o=l.gq.filter(e=>e.userId===t);if(o.length>20){let e=l.gq.findIndex(e=>e.id===o[o.length-1].id);-1!==e&&l.gq.splice(e,1)}return n.NextResponse.json({success:!0,searchHistory:a})}if("report"===r){let{type:t,itemId:r,galleryItemId:s,reporterId:a,reporterName:o,reason:i}=await e.json();if(!t||!r||!a||!o||!i)return n.NextResponse.json({error:"Missing required fields"},{status:400});return console.log("Content reported:",{type:t,itemId:r,galleryItemId:s,reporterId:a,reporterName:o,reason:i,reportedAt:new Date().toISOString()}),n.NextResponse.json({success:!0,message:"Report submitted successfully"})}let{type:s,url:a,title:o,description:i,tags:d,uploaderName:u,uploaderId:c}=await e.json();if(!s||!a||!o)return n.NextResponse.json({error:"Missing required fields"},{status:400});let p=[];d&&"string"==typeof d&&(p=d.split(",").map(e=>e.trim()).filter(e=>e.length>0).slice(0,5));let m="";m="video"===s?function(e){let t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);if(t)return`https://img.youtube.com/vi/${t[1]}/maxresdefault.jpg`;let r=e.match(/vimeo\.com\/(\d+)/);return r?`https://vumbnail.com/${r[1]}.jpg`:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMmEyYTJhIi8+Cjxwb2x5Z29uIHBvaW50cz0iMTIwLDcwIDEyMCwxMzAgMTgwLDEwMCIgZmlsbD0iIzRkNGQ0ZCIvPgo8L3N2Zz4="}(a):a;let g=u||"Anonymous Captain";u&&!u.toLowerCase().includes("captain")&&(g=`${u}`);let w=(0,l.X4)({id:Date.now().toString(),type:s,url:a,thumbnail:m,title:o,description:i||"",uploader:g,uploaderId:c||"dev-user",createdAt:new Date().toISOString(),tags:p,upvotes:0,downvotes:0,viewCount:0});return l.rk.unshift(w),n.NextResponse.json({item:w},{status:201})}catch(e){return console.error("Gallery POST error:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}async function c(e){try{let{searchParams:t}=new URL(e.url),r=t.get("id");if(!r)return n.NextResponse.json({error:"Item ID is required"},{status:400});let s=l.rk.findIndex(e=>e.id===r);if(-1===s)return n.NextResponse.json({error:"Item not found"},{status:404});return l.rk.splice(s,1),l.G_.filter(e=>e.galleryItemId===r).forEach(e=>{let t=l.G_.indexOf(e);t>-1&&l.G_.splice(t,1)}),l.Tn.filter(e=>e.galleryItemId===r).forEach(e=>{let t=l.Tn.indexOf(e);t>-1&&l.Tn.splice(t,1)}),l.lB.filter(e=>e.galleryItemId===r).forEach(e=>{let t=l.lB.indexOf(e);t>-1&&l.lB.splice(t,1)}),n.NextResponse.json({message:"Item deleted successfully"},{status:200})}catch(e){return console.error("Gallery DELETE error:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/gallery/route",pathname:"/api/gallery",filename:"route",bundlePath:"app/api/gallery/route"},resolvedPagePath:"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\api\\gallery\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:g,serverHooks:w}=p;function h(){return(0,i.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:g})}},3245:()=>{},6427:(e,t,r)=>{"use strict";r.d(t,{G_:()=>o,Tn:()=>i,X4:()=>s,gq:()=>l,lB:()=>n,rk:()=>a});let s=e=>({upvotes:Math.floor(20*Math.random()),downvotes:Math.floor(3*Math.random()),viewCount:Math.floor(500*Math.random())+50,tags:[],...e}),a=[s({id:"1",type:"image",url:"https://www.directart.co.uk/mall/images/800s/dhm1519.jpg",thumbnail:"https://www.directart.co.uk/mall/images/800s/dhm1519.jpg",title:"The Battle of Trafalgar",description:"The decisive naval engagement that broke the combined French and Spanish fleets, securing British naval supremacy",uploader:"Admiral Nelson",uploaderId:"demo1",createdAt:new Date("2024-06-20T10:30:00Z").toISOString(),tags:["naval-battle","trafalgar","nelson","historic"],upvotes:15,downvotes:2,viewCount:324}),s({id:"2",type:"image",url:"https://www.directart.co.uk/mall/images/800s/dhm6802pc.jpg",thumbnail:"https://www.directart.co.uk/mall/images/800s/dhm6802pc.jpg",title:"Ships of the Line in Formation",description:"Majestic warships maintaining battle formation, displaying the power and discipline of the Royal Navy",uploader:"Captain Blackwood",uploaderId:"demo2",createdAt:new Date("2024-06-21T14:15:00Z").toISOString(),tags:["ships","formation","royal-navy","tactics"],upvotes:8,downvotes:1,viewCount:156}),s({id:"3",type:"image",url:"https://www.directart.co.uk/mall/images/800s/dhm1165.jpg",thumbnail:"https://www.directart.co.uk/mall/images/800s/dhm1165.jpg",title:"Naval Battle in Stormy Seas",description:"Ships engaging in fierce combat amidst turbulent waters, showcasing the courage of sailors in battle",uploader:"Captain Hardy",uploaderId:"demo3",createdAt:new Date("2024-06-21T16:45:00Z").toISOString(),tags:["storm","battle","courage","naval-combat"],upvotes:12,downvotes:0,viewCount:289}),s({id:"4",type:"image",url:"https://www.directart.co.uk/mall/images/800s/dhm0150.jpg",thumbnail:"https://www.directart.co.uk/mall/images/800s/dhm0150.jpg",title:"Victory at Sea",description:"A triumphant moment as British ships claim victory over enemy vessels in the age of wooden walls",uploader:"Admiral Collingwood",uploaderId:"demo4",createdAt:new Date("2024-06-22T09:20:00Z").toISOString(),tags:["victory","triumph","british-navy"]}),s({id:"5",type:"image",url:"https://www.directart.co.uk/mall/images/800s/dhm0515.jpg",thumbnail:"https://www.directart.co.uk/mall/images/800s/dhm0515.jpg",title:"Fleet Engagement",description:"Multiple ships of the line engaging in a grand naval battle, with cannon smoke filling the horizon",uploader:"Captain Troubridge",uploaderId:"demo5",createdAt:new Date("2024-06-22T11:30:00Z").toISOString(),tags:["fleet","engagement","cannons","smoke"]}),s({id:"collection_demo",type:"collection",url:"https://www.directart.co.uk/mall/images/800s/dhm1519.jpg",thumbnail:"https://www.directart.co.uk/mall/images/800s/dhm1519.jpg",title:"Epic Naval Battle Collection",description:"A collection of dramatic naval battle scenes showcasing the power and glory of maritime warfare",uploader:"Admiral Collection",uploaderId:"demo6",createdAt:new Date("2024-06-23T12:00:00Z").toISOString(),tags:["collection","naval-battles","epic","maritime"],images:["https://www.directart.co.uk/mall/images/800s/dhm1519.jpg","https://www.directart.co.uk/mall/images/800s/dhm6802pc.jpg","https://www.directart.co.uk/mall/images/800s/dhm1165.jpg","https://www.directart.co.uk/mall/images/800s/dhm0150.jpg"],imageCount:4,upvotes:25,downvotes:1,viewCount:450})],o=[],i=[],n=[],l=[]}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9769,4999],()=>r(9312));module.exports=s})();