/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/gallery/route";
exports.ids = ["app/api/gallery/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgallery%2Froute&page=%2Fapi%2Fgallery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgallery%2Froute.ts&appDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgallery%2Froute&page=%2Fapi%2Fgallery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgallery%2Froute.ts&appDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/../../node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_tijer_OneDrive_Documents_krakengaming_apps_frontend_src_app_api_gallery_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/gallery/route.ts */ \"(rsc)/./src/app/api/gallery/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/gallery/route\",\n        pathname: \"/api/gallery\",\n        filename: \"route\",\n        bundlePath: \"app/api/gallery/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\tijer\\\\OneDrive\\\\Documents\\\\krakengaming\\\\apps\\\\frontend\\\\src\\\\app\\\\api\\\\gallery\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_tijer_OneDrive_Documents_krakengaming_apps_frontend_src_app_api_gallery_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGZ2FsbGVyeSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZ2FsbGVyeSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdhbGxlcnklMkZyb3V0ZS50cyZhcHBEaXI9QyUzQSU1Q1VzZXJzJTVDdGlqZXIlNUNPbmVEcml2ZSU1Q0RvY3VtZW50cyU1Q2tyYWtlbmdhbWluZyU1Q2FwcHMlNUNmcm9udGVuZCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDdGlqZXIlNUNPbmVEcml2ZSU1Q0RvY3VtZW50cyU1Q2tyYWtlbmdhbWluZyU1Q2FwcHMlNUNmcm9udGVuZCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDcUQ7QUFDbEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGtyYWtlbmdhbWluZy9mcm9udGVuZC8/NTNhNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcdGlqZXJcXFxcT25lRHJpdmVcXFxcRG9jdW1lbnRzXFxcXGtyYWtlbmdhbWluZ1xcXFxhcHBzXFxcXGZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGdhbGxlcnlcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dhbGxlcnkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9nYWxsZXJ5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9nYWxsZXJ5L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcdGlqZXJcXFxcT25lRHJpdmVcXFxcRG9jdW1lbnRzXFxcXGtyYWtlbmdhbWluZ1xcXFxhcHBzXFxcXGZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGdhbGxlcnlcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgallery%2Froute&page=%2Fapi%2Fgallery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgallery%2Froute.ts&appDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(ssr)/../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/gallery/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/gallery/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/next/dist/api/server.js\");\n\n// Helper function to create gallery items with default enhanced fields\nconst createGalleryItem = (item)=>({\n        upvotes: Math.floor(Math.random() * 20),\n        downvotes: Math.floor(Math.random() * 3),\n        viewCount: Math.floor(Math.random() * 500) + 50,\n        tags: [],\n        ...item\n    });\n// In-memory storage for development (replace with database in production)\nconst galleryItems = [\n    createGalleryItem({\n        id: '1',\n        type: 'image',\n        url: 'https://www.directart.co.uk/mall/images/800s/dhm1519.jpg',\n        thumbnail: 'https://www.directart.co.uk/mall/images/800s/dhm1519.jpg',\n        title: 'The Battle of Trafalgar',\n        description: 'The decisive naval engagement that broke the combined French and Spanish fleets, securing British naval supremacy',\n        uploader: 'Admiral Nelson',\n        uploaderId: 'demo1',\n        createdAt: new Date('2024-06-20T10:30:00Z').toISOString(),\n        tags: [\n            'naval-battle',\n            'trafalgar',\n            'nelson',\n            'historic'\n        ],\n        upvotes: 15,\n        downvotes: 2,\n        viewCount: 324\n    }),\n    createGalleryItem({\n        id: '2',\n        type: 'image',\n        url: 'https://www.directart.co.uk/mall/images/800s/dhm6802pc.jpg',\n        thumbnail: 'https://www.directart.co.uk/mall/images/800s/dhm6802pc.jpg',\n        title: 'Ships of the Line in Formation',\n        description: 'Majestic warships maintaining battle formation, displaying the power and discipline of the Royal Navy',\n        uploader: 'Captain Blackwood',\n        uploaderId: 'demo2',\n        createdAt: new Date('2024-06-21T14:15:00Z').toISOString(),\n        tags: [\n            'ships',\n            'formation',\n            'royal-navy',\n            'tactics'\n        ],\n        upvotes: 8,\n        downvotes: 1,\n        viewCount: 156\n    }),\n    createGalleryItem({\n        id: '3',\n        type: 'image',\n        url: 'https://www.directart.co.uk/mall/images/800s/dhm1165.jpg',\n        thumbnail: 'https://www.directart.co.uk/mall/images/800s/dhm1165.jpg',\n        title: 'Naval Battle in Stormy Seas',\n        description: 'Ships engaging in fierce combat amidst turbulent waters, showcasing the courage of sailors in battle',\n        uploader: 'Captain Hardy',\n        uploaderId: 'demo3',\n        createdAt: new Date('2024-06-21T16:45:00Z').toISOString(),\n        tags: [\n            'storm',\n            'battle',\n            'courage',\n            'naval-combat'\n        ],\n        upvotes: 12,\n        downvotes: 0,\n        viewCount: 289\n    }),\n    createGalleryItem({\n        id: '4',\n        type: 'image',\n        url: 'https://www.directart.co.uk/mall/images/800s/dhm0150.jpg',\n        thumbnail: 'https://www.directart.co.uk/mall/images/800s/dhm0150.jpg',\n        title: 'Victory at Sea',\n        description: 'A triumphant moment as British ships claim victory over enemy vessels in the age of wooden walls',\n        uploader: 'Admiral Collingwood',\n        uploaderId: 'demo4',\n        createdAt: new Date('2024-06-22T09:20:00Z').toISOString(),\n        tags: [\n            'victory',\n            'triumph',\n            'british-navy'\n        ]\n    }),\n    createGalleryItem({\n        id: '5',\n        type: 'image',\n        url: 'https://www.directart.co.uk/mall/images/800s/dhm0515.jpg',\n        thumbnail: 'https://www.directart.co.uk/mall/images/800s/dhm0515.jpg',\n        title: 'Fleet Engagement',\n        description: 'Multiple ships of the line engaging in a grand naval battle, with cannon smoke filling the horizon',\n        uploader: 'Captain Troubridge',\n        uploaderId: 'demo5',\n        createdAt: new Date('2024-06-22T11:30:00Z').toISOString(),\n        tags: [\n            'fleet',\n            'engagement',\n            'cannons',\n            'smoke'\n        ]\n    })\n];\n// In-memory storage for development\nconst comments = [];\nconst votes = [];\nconst favorites = [];\nconst searchHistoryItems = [];\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        // Check if this is a request for a specific feature\n        const feature = searchParams.get('feature');\n        const galleryItemId = searchParams.get('galleryItemId');\n        const userId = searchParams.get('userId');\n        // Handle comments endpoint\n        if (feature === 'comments' && galleryItemId) {\n            const itemComments = comments.filter((c)=>c.galleryItemId === galleryItemId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                comments: itemComments\n            });\n        }\n        // Handle votes endpoint\n        if (feature === 'votes' && galleryItemId && userId) {\n            const userVote = votes.find((v)=>v.galleryItemId === galleryItemId && v.userId === userId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                vote: userVote || null\n            });\n        }\n        // Handle favorites endpoint\n        if (feature === 'favorites' && userId) {\n            if (galleryItemId) {\n                const isFavorited = favorites.some((f)=>f.galleryItemId === galleryItemId && f.userId === userId);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    isFavorited\n                });\n            } else {\n                const userFavorites = favorites.filter((f)=>f.userId === userId);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    favorites: userFavorites\n                });\n            }\n        }\n        // Handle search history endpoint\n        if (feature === 'search-history' && userId) {\n            const userSearchHistory = searchHistoryItems.filter((s)=>s.userId === userId).sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()).slice(0, 10); // Last 10 searches\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                searchHistory: userSearchHistory\n            });\n        }\n        // Regular gallery items endpoint\n        // Pagination parameters\n        const page = parseInt(searchParams.get('page') || '1');\n        const limit = parseInt(searchParams.get('limit') || '12');\n        // Sorting parameters\n        const sortBy = searchParams.get('sortBy') || 'createdAt';\n        const sortOrder = searchParams.get('sortOrder') || 'desc';\n        // Search parameter\n        const search = searchParams.get('search') || '';\n        // Date filtering parameters\n        const dateFilter = searchParams.get('dateFilter') || '';\n        const dateRangeEnd = searchParams.get('dateRangeEnd') || '';\n        // Filter items based on search\n        let filteredItems = galleryItems;\n        if (search) {\n            const searchLower = search.toLowerCase();\n            filteredItems = galleryItems.filter((item)=>item.title.toLowerCase().includes(searchLower) || item.description.toLowerCase().includes(searchLower) || item.uploader.toLowerCase().includes(searchLower) || item.tags.some((tag)=>tag.toLowerCase().includes(searchLower)));\n        }\n        // Filter by date if provided\n        if (dateFilter || dateRangeEnd) {\n            filteredItems = filteredItems.filter((item)=>{\n                const itemDate = new Date(item.createdAt);\n                if (dateFilter && dateRangeEnd) {\n                    // Date range\n                    const startDate = new Date(dateFilter);\n                    const endDate = new Date(dateRangeEnd);\n                    endDate.setHours(23, 59, 59, 999); // Include the entire end day\n                    return itemDate >= startDate && itemDate <= endDate;\n                } else if (dateFilter) {\n                    // Exact date (or starting date)\n                    const filterDate = new Date(dateFilter);\n                    const nextDay = new Date(filterDate);\n                    nextDay.setDate(nextDay.getDate() + 1);\n                    return itemDate >= filterDate && itemDate < nextDay;\n                }\n                return true;\n            });\n        }\n        // Sort items\n        filteredItems.sort((a, b)=>{\n            let aValue, bValue;\n            switch(sortBy){\n                case 'createdAt':\n                    aValue = new Date(a.createdAt);\n                    bValue = new Date(b.createdAt);\n                    break;\n                case 'title':\n                    aValue = a.title.toLowerCase();\n                    bValue = b.title.toLowerCase();\n                    break;\n                case 'uploader':\n                    aValue = a.uploader.toLowerCase();\n                    bValue = b.uploader.toLowerCase();\n                    break;\n                case 'upvotes':\n                    aValue = a.upvotes;\n                    bValue = b.upvotes;\n                    break;\n                case 'viewCount':\n                    aValue = a.viewCount;\n                    bValue = b.viewCount;\n                    break;\n                default:\n                    aValue = new Date(a.createdAt);\n                    bValue = new Date(b.createdAt);\n            }\n            if (sortOrder === 'asc') {\n                return aValue > bValue ? 1 : -1;\n            } else {\n                return aValue < bValue ? 1 : -1;\n            }\n        });\n        // Calculate pagination\n        const totalItems = filteredItems.length;\n        const totalPages = Math.ceil(totalItems / limit);\n        const startIndex = (page - 1) * limit;\n        const endIndex = startIndex + limit;\n        const paginatedItems = filteredItems.slice(startIndex, endIndex);\n        // Return paginated results with metadata\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            items: paginatedItems,\n            pagination: {\n                currentPage: page,\n                totalPages,\n                totalItems,\n                itemsPerPage: limit,\n                hasNextPage: page < totalPages,\n                hasPrevPage: page > 1\n            },\n            filters: {\n                search,\n                sortBy,\n                sortOrder,\n                dateFilter,\n                dateRangeEnd\n            }\n        });\n    } catch (error) {\n        console.error('Gallery GET error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const feature = searchParams.get('feature');\n        // Handle different POST features\n        if (feature === 'vote') {\n            const { galleryItemId, userId, voteType } = await request.json();\n            if (!galleryItemId || !userId || !voteType) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Missing required fields'\n                }, {\n                    status: 400\n                });\n            }\n            // Remove existing vote\n            const existingVoteIndex = votes.findIndex((v)=>v.galleryItemId === galleryItemId && v.userId === userId);\n            if (existingVoteIndex !== -1) {\n                const existingVote = votes[existingVoteIndex];\n                votes.splice(existingVoteIndex, 1);\n                // Update gallery item vote counts\n                const item = galleryItems.find((i)=>i.id === galleryItemId);\n                if (item) {\n                    if (existingVote.voteType === 'upvote') {\n                        item.upvotes = Math.max(0, item.upvotes - 1);\n                    } else {\n                        item.downvotes = Math.max(0, item.downvotes - 1);\n                    }\n                }\n                // If same vote type, just remove (toggle off)\n                if (existingVote.voteType === voteType) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        vote: null\n                    });\n                }\n            }\n            // Add new vote\n            const newVote = {\n                id: Date.now().toString(),\n                galleryItemId,\n                userId,\n                voteType: voteType,\n                createdAt: new Date().toISOString()\n            };\n            votes.push(newVote);\n            // Update gallery item vote counts\n            const item = galleryItems.find((i)=>i.id === galleryItemId);\n            if (item) {\n                if (voteType === 'upvote') {\n                    item.upvotes++;\n                } else {\n                    item.downvotes++;\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                vote: newVote\n            });\n        }\n        if (feature === 'favorite') {\n            const { galleryItemId, userId } = await request.json();\n            if (!galleryItemId || !userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Missing required fields'\n                }, {\n                    status: 400\n                });\n            }\n            // Check if already favorited\n            const existingFavoriteIndex = favorites.findIndex((f)=>f.galleryItemId === galleryItemId && f.userId === userId);\n            if (existingFavoriteIndex !== -1) {\n                // Remove favorite (toggle off)\n                favorites.splice(existingFavoriteIndex, 1);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    isFavorited: false\n                });\n            } else {\n                // Add favorite\n                const newFavorite = {\n                    id: Date.now().toString(),\n                    galleryItemId,\n                    userId,\n                    createdAt: new Date().toISOString()\n                };\n                favorites.push(newFavorite);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    isFavorited: true\n                });\n            }\n        }\n        if (feature === 'comment') {\n            const { galleryItemId, userId, userName, content } = await request.json();\n            if (!galleryItemId || !userId || !userName || !content?.trim()) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Missing required fields'\n                }, {\n                    status: 400\n                });\n            }\n            const newComment = {\n                id: Date.now().toString(),\n                galleryItemId,\n                userId,\n                userName,\n                content: content.trim(),\n                createdAt: new Date().toISOString()\n            };\n            comments.push(newComment);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                comment: newComment\n            });\n        }\n        if (feature === 'search-history') {\n            const { userId, searchTerm } = await request.json();\n            if (!userId || !searchTerm?.trim()) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Missing required fields'\n                }, {\n                    status: 400\n                });\n            }\n            // Remove existing search term if it exists\n            const existingIndex = searchHistoryItems.findIndex((s)=>s.userId === userId && s.searchTerm === searchTerm.trim());\n            if (existingIndex !== -1) {\n                searchHistoryItems.splice(existingIndex, 1);\n            }\n            // Add new search history item\n            const newSearchHistory = {\n                id: Date.now().toString(),\n                userId,\n                searchTerm: searchTerm.trim(),\n                createdAt: new Date().toISOString()\n            };\n            searchHistoryItems.unshift(newSearchHistory); // Add to beginning\n            // Keep only last 20 searches per user\n            const userSearches = searchHistoryItems.filter((s)=>s.userId === userId);\n            if (userSearches.length > 20) {\n                const oldestSearchIndex = searchHistoryItems.findIndex((s)=>s.id === userSearches[userSearches.length - 1].id);\n                if (oldestSearchIndex !== -1) {\n                    searchHistoryItems.splice(oldestSearchIndex, 1);\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                searchHistory: newSearchHistory\n            });\n        }\n        // Regular gallery item upload\n        const { type, url, title, description, tags, uploaderName, uploaderId } = await request.json();\n        if (!type || !url || !title) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Missing required fields'\n            }, {\n                status: 400\n            });\n        }\n        // Process tags if provided\n        let processedTags = [];\n        if (tags && typeof tags === 'string') {\n            processedTags = tags.split(',').map((tag)=>tag.trim()).filter((tag)=>tag.length > 0).slice(0, 5); // Limit to 5 tags\n        }\n        // Generate thumbnail for video URLs\n        let thumbnail = '';\n        if (type === 'video') {\n            thumbnail = generateVideoThumbnail(url);\n        } else {\n            thumbnail = url; // For images, use the image itself as thumbnail\n        }\n        // Format the uploader name\n        let formattedUploaderName = uploaderName || 'Anonymous Captain';\n        if (uploaderName && !uploaderName.toLowerCase().includes('captain')) {\n            formattedUploaderName = `${uploaderName}`;\n        }\n        const newItem = createGalleryItem({\n            id: Date.now().toString(),\n            type,\n            url,\n            thumbnail,\n            title,\n            description: description || '',\n            uploader: formattedUploaderName,\n            uploaderId: uploaderId || 'dev-user',\n            createdAt: new Date().toISOString(),\n            tags: processedTags,\n            upvotes: 0,\n            downvotes: 0,\n            viewCount: 0\n        });\n        galleryItems.unshift(newItem); // Add to beginning of array\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            item: newItem\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error('Gallery POST error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function DELETE(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const itemId = searchParams.get('id');\n        if (!itemId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Item ID is required'\n            }, {\n                status: 400\n            });\n        }\n        const itemIndex = galleryItems.findIndex((item)=>item.id === itemId);\n        if (itemIndex === -1) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Item not found'\n            }, {\n                status: 404\n            });\n        }\n        galleryItems.splice(itemIndex, 1);\n        // Also remove related comments, votes, and favorites\n        const commentsToRemove = comments.filter((c)=>c.galleryItemId === itemId);\n        commentsToRemove.forEach((comment)=>{\n            const index = comments.indexOf(comment);\n            if (index > -1) comments.splice(index, 1);\n        });\n        const votesToRemove = votes.filter((v)=>v.galleryItemId === itemId);\n        votesToRemove.forEach((vote)=>{\n            const index = votes.indexOf(vote);\n            if (index > -1) votes.splice(index, 1);\n        });\n        const favoritesToRemove = favorites.filter((f)=>f.galleryItemId === itemId);\n        favoritesToRemove.forEach((favorite)=>{\n            const index = favorites.indexOf(favorite);\n            if (index > -1) favorites.splice(index, 1);\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: 'Item deleted successfully'\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error('Gallery DELETE error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\nfunction generateVideoThumbnail(url) {\n    // YouTube thumbnail extraction\n    const youtubeMatch = url.match(/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\n?#]+)/);\n    if (youtubeMatch) {\n        return `https://img.youtube.com/vi/${youtubeMatch[1]}/maxresdefault.jpg`;\n    }\n    // Vimeo thumbnail (would need API call in production)\n    const vimeoMatch = url.match(/vimeo\\.com\\/(\\d+)/);\n    if (vimeoMatch) {\n        return `https://vumbnail.com/${vimeoMatch[1]}.jpg`;\n    }\n    // Default video placeholder\n    return '/api/placeholder/video-thumbnail';\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sQ0FBQ2lDLE9BQU87UUFDdEM7UUFFQSxNQUFNRyxvQkFBb0IvRyxVQUFVVyxNQUFNLENBQUNTLENBQUFBLElBQUtBLEVBQUVaLGFBQWEsS0FBS2dHO1FBQ3BFTyxrQkFBa0JKLE9BQU8sQ0FBQ0ssQ0FBQUE7WUFDeEIsTUFBTUosUUFBUTVHLFVBQVU2RyxPQUFPLENBQUNHO1lBQ2hDLElBQUlKLFFBQVEsQ0FBQyxHQUFHNUcsVUFBVTJFLE1BQU0sQ0FBQ2lDLE9BQU87UUFDMUM7UUFFQSxPQUFPcEkscURBQVlBLENBQUNxQyxJQUFJLENBQUM7WUFBRW9HLFNBQVM7UUFBNEIsR0FBRztZQUFFNUMsUUFBUTtRQUFJO0lBQ25GLEVBQUUsT0FBT0YsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxPQUFPM0YscURBQVlBLENBQUNxQyxJQUFJLENBQUM7WUFBRXNELE9BQU87UUFBd0IsR0FBRztZQUFFRSxRQUFRO1FBQUk7SUFDN0U7QUFDRjtBQUVBLFNBQVMrQix1QkFBdUIvRyxHQUFXO0lBQ3pDLCtCQUErQjtJQUMvQixNQUFNNkgsZUFBZTdILElBQUk4SCxLQUFLLENBQUM7SUFDL0IsSUFBSUQsY0FBYztRQUNoQixPQUFPLENBQUMsMkJBQTJCLEVBQUVBLFlBQVksQ0FBQyxFQUFFLENBQUMsa0JBQWtCLENBQUM7SUFDMUU7SUFFQSxzREFBc0Q7SUFDdEQsTUFBTUUsYUFBYS9ILElBQUk4SCxLQUFLLENBQUM7SUFDN0IsSUFBSUMsWUFBWTtRQUNkLE9BQU8sQ0FBQyxxQkFBcUIsRUFBRUEsVUFBVSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUM7SUFDcEQ7SUFFQSw0QkFBNEI7SUFDNUIsT0FBTztBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGtyYWtlbmdhbWluZy9mcm9udGVuZC8uL3NyYy9hcHAvYXBpL2dhbGxlcnkvcm91dGUudHM/NDZiMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGdhbGxlcnkgaXRlbXMgd2l0aCBkZWZhdWx0IGVuaGFuY2VkIGZpZWxkc1xuY29uc3QgY3JlYXRlR2FsbGVyeUl0ZW0gPSAoaXRlbTogUGFydGlhbDxHYWxsZXJ5SXRlbT4pOiBHYWxsZXJ5SXRlbSA9PiAoe1xuICB1cHZvdGVzOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyMCksXG4gIGRvd252b3RlczogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyksXG4gIHZpZXdDb3VudDogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNTAwKSArIDUwLFxuICB0YWdzOiBbXSxcbiAgLi4uaXRlbSxcbn0gYXMgR2FsbGVyeUl0ZW0pO1xuXG4vLyBJbnRlcmZhY2VzXG5leHBvcnQgaW50ZXJmYWNlIEdhbGxlcnlJdGVtIHtcbiAgaWQ6IHN0cmluZztcbiAgdHlwZTogJ2ltYWdlJyB8ICd2aWRlbyc7XG4gIHVybDogc3RyaW5nO1xuICB0aHVtYm5haWw/OiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHVwbG9hZGVyOiBzdHJpbmc7XG4gIHVwbG9hZGVySWQ6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIC8vIE5ldyBmaWVsZHMgZm9yIGVuaGFuY2VkIGZlYXR1cmVzXG4gIHVwdm90ZXM6IG51bWJlcjtcbiAgZG93bnZvdGVzOiBudW1iZXI7XG4gIHZpZXdDb3VudDogbnVtYmVyO1xuICB0YWdzOiBzdHJpbmdbXTtcbiAgZmlsZVNpemU/OiBudW1iZXI7XG4gIGRpbWVuc2lvbnM/OiB7XG4gICAgd2lkdGg6IG51bWJlcjtcbiAgICBoZWlnaHQ6IG51bWJlcjtcbiAgfTtcbiAgb3JpZ2luYWxGaWxlTmFtZT86IHN0cmluZztcbiAgbWltZVR5cGU/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2FsbGVyeUNvbW1lbnQge1xuICBpZDogc3RyaW5nO1xuICBnYWxsZXJ5SXRlbUlkOiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xuICB1c2VyTmFtZTogc3RyaW5nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICB1cGRhdGVkQXQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2FsbGVyeVZvdGUge1xuICBpZDogc3RyaW5nO1xuICBnYWxsZXJ5SXRlbUlkOiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xuICB2b3RlVHlwZTogJ3Vwdm90ZScgfCAnZG93bnZvdGUnO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHYWxsZXJ5RmF2b3JpdGUge1xuICBpZDogc3RyaW5nO1xuICBnYWxsZXJ5SXRlbUlkOiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hIaXN0b3J5IHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHNlYXJjaFRlcm06IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbi8vIEluLW1lbW9yeSBzdG9yYWdlIGZvciBkZXZlbG9wbWVudCAocmVwbGFjZSB3aXRoIGRhdGFiYXNlIGluIHByb2R1Y3Rpb24pXG5jb25zdCBnYWxsZXJ5SXRlbXM6IEdhbGxlcnlJdGVtW10gPSBbXG4gIGNyZWF0ZUdhbGxlcnlJdGVtKHtcbiAgICBpZDogJzEnLFxuICAgIHR5cGU6ICdpbWFnZScsXG4gICAgdXJsOiAnaHR0cHM6Ly93d3cuZGlyZWN0YXJ0LmNvLnVrL21hbGwvaW1hZ2VzLzgwMHMvZGhtMTUxOS5qcGcnLFxuICAgIHRodW1ibmFpbDogJ2h0dHBzOi8vd3d3LmRpcmVjdGFydC5jby51ay9tYWxsL2ltYWdlcy84MDBzL2RobTE1MTkuanBnJyxcbiAgICB0aXRsZTogJ1RoZSBCYXR0bGUgb2YgVHJhZmFsZ2FyJyxcbiAgICBkZXNjcmlwdGlvbjogJ1RoZSBkZWNpc2l2ZSBuYXZhbCBlbmdhZ2VtZW50IHRoYXQgYnJva2UgdGhlIGNvbWJpbmVkIEZyZW5jaCBhbmQgU3BhbmlzaCBmbGVldHMsIHNlY3VyaW5nIEJyaXRpc2ggbmF2YWwgc3VwcmVtYWN5JyxcbiAgICB1cGxvYWRlcjogJ0FkbWlyYWwgTmVsc29uJyxcbiAgICB1cGxvYWRlcklkOiAnZGVtbzEnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDYtMjBUMTA6MzA6MDBaJykudG9JU09TdHJpbmcoKSxcbiAgICB0YWdzOiBbJ25hdmFsLWJhdHRsZScsICd0cmFmYWxnYXInLCAnbmVsc29uJywgJ2hpc3RvcmljJ10sXG4gICAgdXB2b3RlczogMTUsXG4gICAgZG93bnZvdGVzOiAyLFxuICAgIHZpZXdDb3VudDogMzI0LFxuICB9KSxcbiAgY3JlYXRlR2FsbGVyeUl0ZW0oe1xuICAgIGlkOiAnMicsXG4gICAgdHlwZTogJ2ltYWdlJyxcbiAgICB1cmw6ICdodHRwczovL3d3dy5kaXJlY3RhcnQuY28udWsvbWFsbC9pbWFnZXMvODAwcy9kaG02ODAycGMuanBnJyxcbiAgICB0aHVtYm5haWw6ICdodHRwczovL3d3dy5kaXJlY3RhcnQuY28udWsvbWFsbC9pbWFnZXMvODAwcy9kaG02ODAycGMuanBnJyxcbiAgICB0aXRsZTogJ1NoaXBzIG9mIHRoZSBMaW5lIGluIEZvcm1hdGlvbicsXG4gICAgZGVzY3JpcHRpb246ICdNYWplc3RpYyB3YXJzaGlwcyBtYWludGFpbmluZyBiYXR0bGUgZm9ybWF0aW9uLCBkaXNwbGF5aW5nIHRoZSBwb3dlciBhbmQgZGlzY2lwbGluZSBvZiB0aGUgUm95YWwgTmF2eScsXG4gICAgdXBsb2FkZXI6ICdDYXB0YWluIEJsYWNrd29vZCcsXG4gICAgdXBsb2FkZXJJZDogJ2RlbW8yJyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTA2LTIxVDE0OjE1OjAwWicpLnRvSVNPU3RyaW5nKCksXG4gICAgdGFnczogWydzaGlwcycsICdmb3JtYXRpb24nLCAncm95YWwtbmF2eScsICd0YWN0aWNzJ10sXG4gICAgdXB2b3RlczogOCxcbiAgICBkb3dudm90ZXM6IDEsXG4gICAgdmlld0NvdW50OiAxNTYsXG4gIH0pLFxuICBjcmVhdGVHYWxsZXJ5SXRlbSh7XG4gICAgaWQ6ICczJyxcbiAgICB0eXBlOiAnaW1hZ2UnLFxuICAgIHVybDogJ2h0dHBzOi8vd3d3LmRpcmVjdGFydC5jby51ay9tYWxsL2ltYWdlcy84MDBzL2RobTExNjUuanBnJyxcbiAgICB0aHVtYm5haWw6ICdodHRwczovL3d3dy5kaXJlY3RhcnQuY28udWsvbWFsbC9pbWFnZXMvODAwcy9kaG0xMTY1LmpwZycsXG4gICAgdGl0bGU6ICdOYXZhbCBCYXR0bGUgaW4gU3Rvcm15IFNlYXMnLFxuICAgIGRlc2NyaXB0aW9uOiAnU2hpcHMgZW5nYWdpbmcgaW4gZmllcmNlIGNvbWJhdCBhbWlkc3QgdHVyYnVsZW50IHdhdGVycywgc2hvd2Nhc2luZyB0aGUgY291cmFnZSBvZiBzYWlsb3JzIGluIGJhdHRsZScsXG4gICAgdXBsb2FkZXI6ICdDYXB0YWluIEhhcmR5JyxcbiAgICB1cGxvYWRlcklkOiAnZGVtbzMnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDYtMjFUMTY6NDU6MDBaJykudG9JU09TdHJpbmcoKSxcbiAgICB0YWdzOiBbJ3N0b3JtJywgJ2JhdHRsZScsICdjb3VyYWdlJywgJ25hdmFsLWNvbWJhdCddLFxuICAgIHVwdm90ZXM6IDEyLFxuICAgIGRvd252b3RlczogMCxcbiAgICB2aWV3Q291bnQ6IDI4OSxcbiAgfSksXG4gIGNyZWF0ZUdhbGxlcnlJdGVtKHtcbiAgICBpZDogJzQnLFxuICAgIHR5cGU6ICdpbWFnZScsXG4gICAgdXJsOiAnaHR0cHM6Ly93d3cuZGlyZWN0YXJ0LmNvLnVrL21hbGwvaW1hZ2VzLzgwMHMvZGhtMDE1MC5qcGcnLFxuICAgIHRodW1ibmFpbDogJ2h0dHBzOi8vd3d3LmRpcmVjdGFydC5jby51ay9tYWxsL2ltYWdlcy84MDBzL2RobTAxNTAuanBnJyxcbiAgICB0aXRsZTogJ1ZpY3RvcnkgYXQgU2VhJyxcbiAgICBkZXNjcmlwdGlvbjogJ0EgdHJpdW1waGFudCBtb21lbnQgYXMgQnJpdGlzaCBzaGlwcyBjbGFpbSB2aWN0b3J5IG92ZXIgZW5lbXkgdmVzc2VscyBpbiB0aGUgYWdlIG9mIHdvb2RlbiB3YWxscycsXG4gICAgdXBsb2FkZXI6ICdBZG1pcmFsIENvbGxpbmd3b29kJyxcbiAgICB1cGxvYWRlcklkOiAnZGVtbzQnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDYtMjJUMDk6MjA6MDBaJykudG9JU09TdHJpbmcoKSxcbiAgICB0YWdzOiBbJ3ZpY3RvcnknLCAndHJpdW1waCcsICdicml0aXNoLW5hdnknXSxcbiAgfSksXG4gIGNyZWF0ZUdhbGxlcnlJdGVtKHtcbiAgICBpZDogJzUnLFxuICAgIHR5cGU6ICdpbWFnZScsXG4gICAgdXJsOiAnaHR0cHM6Ly93d3cuZGlyZWN0YXJ0LmNvLnVrL21hbGwvaW1hZ2VzLzgwMHMvZGhtMDUxNS5qcGcnLFxuICAgIHRodW1ibmFpbDogJ2h0dHBzOi8vd3d3LmRpcmVjdGFydC5jby51ay9tYWxsL2ltYWdlcy84MDBzL2RobTA1MTUuanBnJyxcbiAgICB0aXRsZTogJ0ZsZWV0IEVuZ2FnZW1lbnQnLFxuICAgIGRlc2NyaXB0aW9uOiAnTXVsdGlwbGUgc2hpcHMgb2YgdGhlIGxpbmUgZW5nYWdpbmcgaW4gYSBncmFuZCBuYXZhbCBiYXR0bGUsIHdpdGggY2Fubm9uIHNtb2tlIGZpbGxpbmcgdGhlIGhvcml6b24nLFxuICAgIHVwbG9hZGVyOiAnQ2FwdGFpbiBUcm91YnJpZGdlJyxcbiAgICB1cGxvYWRlcklkOiAnZGVtbzUnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDYtMjJUMTE6MzA6MDBaJykudG9JU09TdHJpbmcoKSxcbiAgICB0YWdzOiBbJ2ZsZWV0JywgJ2VuZ2FnZW1lbnQnLCAnY2Fubm9ucycsICdzbW9rZSddLFxuICB9KVxuXTtcblxuLy8gSW4tbWVtb3J5IHN0b3JhZ2UgZm9yIGRldmVsb3BtZW50XG5jb25zdCBjb21tZW50czogR2FsbGVyeUNvbW1lbnRbXSA9IFtdO1xuY29uc3Qgdm90ZXM6IEdhbGxlcnlWb3RlW10gPSBbXTtcbmNvbnN0IGZhdm9yaXRlczogR2FsbGVyeUZhdm9yaXRlW10gPSBbXTtcbmNvbnN0IHNlYXJjaEhpc3RvcnlJdGVtczogU2VhcmNoSGlzdG9yeVtdID0gW107XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG5cbiAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgcmVxdWVzdCBmb3IgYSBzcGVjaWZpYyBmZWF0dXJlXG4gICAgY29uc3QgZmVhdHVyZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2ZlYXR1cmUnKTtcbiAgICBjb25zdCBnYWxsZXJ5SXRlbUlkID0gc2VhcmNoUGFyYW1zLmdldCgnZ2FsbGVyeUl0ZW1JZCcpO1xuICAgIGNvbnN0IHVzZXJJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3VzZXJJZCcpO1xuXG4gICAgLy8gSGFuZGxlIGNvbW1lbnRzIGVuZHBvaW50XG4gICAgaWYgKGZlYXR1cmUgPT09ICdjb21tZW50cycgJiYgZ2FsbGVyeUl0ZW1JZCkge1xuICAgICAgY29uc3QgaXRlbUNvbW1lbnRzID0gY29tbWVudHMuZmlsdGVyKGMgPT4gYy5nYWxsZXJ5SXRlbUlkID09PSBnYWxsZXJ5SXRlbUlkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNvbW1lbnRzOiBpdGVtQ29tbWVudHMgfSk7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHZvdGVzIGVuZHBvaW50XG4gICAgaWYgKGZlYXR1cmUgPT09ICd2b3RlcycgJiYgZ2FsbGVyeUl0ZW1JZCAmJiB1c2VySWQpIHtcbiAgICAgIGNvbnN0IHVzZXJWb3RlID0gdm90ZXMuZmluZCh2ID0+IHYuZ2FsbGVyeUl0ZW1JZCA9PT0gZ2FsbGVyeUl0ZW1JZCAmJiB2LnVzZXJJZCA9PT0gdXNlcklkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHZvdGU6IHVzZXJWb3RlIHx8IG51bGwgfSk7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGZhdm9yaXRlcyBlbmRwb2ludFxuICAgIGlmIChmZWF0dXJlID09PSAnZmF2b3JpdGVzJyAmJiB1c2VySWQpIHtcbiAgICAgIGlmIChnYWxsZXJ5SXRlbUlkKSB7XG4gICAgICAgIGNvbnN0IGlzRmF2b3JpdGVkID0gZmF2b3JpdGVzLnNvbWUoZiA9PiBmLmdhbGxlcnlJdGVtSWQgPT09IGdhbGxlcnlJdGVtSWQgJiYgZi51c2VySWQgPT09IHVzZXJJZCk7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGlzRmF2b3JpdGVkIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdXNlckZhdm9yaXRlcyA9IGZhdm9yaXRlcy5maWx0ZXIoZiA9PiBmLnVzZXJJZCA9PT0gdXNlcklkKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZmF2b3JpdGVzOiB1c2VyRmF2b3JpdGVzIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBzZWFyY2ggaGlzdG9yeSBlbmRwb2ludFxuICAgIGlmIChmZWF0dXJlID09PSAnc2VhcmNoLWhpc3RvcnknICYmIHVzZXJJZCkge1xuICAgICAgY29uc3QgdXNlclNlYXJjaEhpc3RvcnkgPSBzZWFyY2hIaXN0b3J5SXRlbXMuZmlsdGVyKHMgPT4gcy51c2VySWQgPT09IHVzZXJJZClcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIuY3JlYXRlZEF0KS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLmNyZWF0ZWRBdCkuZ2V0VGltZSgpKVxuICAgICAgICAuc2xpY2UoMCwgMTApOyAvLyBMYXN0IDEwIHNlYXJjaGVzXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzZWFyY2hIaXN0b3J5OiB1c2VyU2VhcmNoSGlzdG9yeSB9KTtcbiAgICB9XG5cbiAgICAvLyBSZWd1bGFyIGdhbGxlcnkgaXRlbXMgZW5kcG9pbnRcbiAgICAvLyBQYWdpbmF0aW9uIHBhcmFtZXRlcnNcbiAgICBjb25zdCBwYWdlID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgncGFnZScpIHx8ICcxJyk7XG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICcxMicpO1xuXG4gICAgLy8gU29ydGluZyBwYXJhbWV0ZXJzXG4gICAgY29uc3Qgc29ydEJ5ID0gc2VhcmNoUGFyYW1zLmdldCgnc29ydEJ5JykgfHwgJ2NyZWF0ZWRBdCc7XG4gICAgY29uc3Qgc29ydE9yZGVyID0gc2VhcmNoUGFyYW1zLmdldCgnc29ydE9yZGVyJykgfHwgJ2Rlc2MnO1xuXG4gICAgLy8gU2VhcmNoIHBhcmFtZXRlclxuICAgIGNvbnN0IHNlYXJjaCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NlYXJjaCcpIHx8ICcnO1xuXG4gICAgLy8gRGF0ZSBmaWx0ZXJpbmcgcGFyYW1ldGVyc1xuICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSBzZWFyY2hQYXJhbXMuZ2V0KCdkYXRlRmlsdGVyJykgfHwgJyc7XG4gICAgY29uc3QgZGF0ZVJhbmdlRW5kID0gc2VhcmNoUGFyYW1zLmdldCgnZGF0ZVJhbmdlRW5kJykgfHwgJyc7XG5cbiAgICAvLyBGaWx0ZXIgaXRlbXMgYmFzZWQgb24gc2VhcmNoXG4gICAgbGV0IGZpbHRlcmVkSXRlbXMgPSBnYWxsZXJ5SXRlbXM7XG4gICAgaWYgKHNlYXJjaCkge1xuICAgICAgY29uc3Qgc2VhcmNoTG93ZXIgPSBzZWFyY2gudG9Mb3dlckNhc2UoKTtcbiAgICAgIGZpbHRlcmVkSXRlbXMgPSBnYWxsZXJ5SXRlbXMuZmlsdGVyKGl0ZW0gPT5cbiAgICAgICAgaXRlbS50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxuICAgICAgICBpdGVtLmRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoTG93ZXIpIHx8XG4gICAgICAgIGl0ZW0udXBsb2FkZXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hMb3dlcikgfHxcbiAgICAgICAgaXRlbS50YWdzLnNvbWUodGFnID0+IHRhZy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gRmlsdGVyIGJ5IGRhdGUgaWYgcHJvdmlkZWRcbiAgICBpZiAoZGF0ZUZpbHRlciB8fCBkYXRlUmFuZ2VFbmQpIHtcbiAgICAgIGZpbHRlcmVkSXRlbXMgPSBmaWx0ZXJlZEl0ZW1zLmZpbHRlcihpdGVtID0+IHtcbiAgICAgICAgY29uc3QgaXRlbURhdGUgPSBuZXcgRGF0ZShpdGVtLmNyZWF0ZWRBdCk7XG5cbiAgICAgICAgaWYgKGRhdGVGaWx0ZXIgJiYgZGF0ZVJhbmdlRW5kKSB7XG4gICAgICAgICAgLy8gRGF0ZSByYW5nZVxuICAgICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKGRhdGVGaWx0ZXIpO1xuICAgICAgICAgIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZShkYXRlUmFuZ2VFbmQpO1xuICAgICAgICAgIGVuZERhdGUuc2V0SG91cnMoMjMsIDU5LCA1OSwgOTk5KTsgLy8gSW5jbHVkZSB0aGUgZW50aXJlIGVuZCBkYXlcbiAgICAgICAgICByZXR1cm4gaXRlbURhdGUgPj0gc3RhcnREYXRlICYmIGl0ZW1EYXRlIDw9IGVuZERhdGU7XG4gICAgICAgIH0gZWxzZSBpZiAoZGF0ZUZpbHRlcikge1xuICAgICAgICAgIC8vIEV4YWN0IGRhdGUgKG9yIHN0YXJ0aW5nIGRhdGUpXG4gICAgICAgICAgY29uc3QgZmlsdGVyRGF0ZSA9IG5ldyBEYXRlKGRhdGVGaWx0ZXIpO1xuICAgICAgICAgIGNvbnN0IG5leHREYXkgPSBuZXcgRGF0ZShmaWx0ZXJEYXRlKTtcbiAgICAgICAgICBuZXh0RGF5LnNldERhdGUobmV4dERheS5nZXREYXRlKCkgKyAxKTtcbiAgICAgICAgICByZXR1cm4gaXRlbURhdGUgPj0gZmlsdGVyRGF0ZSAmJiBpdGVtRGF0ZSA8IG5leHREYXk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFNvcnQgaXRlbXNcbiAgICBmaWx0ZXJlZEl0ZW1zLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIGxldCBhVmFsdWU6IHN0cmluZyB8IERhdGUgfCBudW1iZXIsIGJWYWx1ZTogc3RyaW5nIHwgRGF0ZSB8IG51bWJlcjtcblxuICAgICAgc3dpdGNoIChzb3J0QnkpIHtcbiAgICAgICAgY2FzZSAnY3JlYXRlZEF0JzpcbiAgICAgICAgICBhVmFsdWUgPSBuZXcgRGF0ZShhLmNyZWF0ZWRBdCk7XG4gICAgICAgICAgYlZhbHVlID0gbmV3IERhdGUoYi5jcmVhdGVkQXQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd0aXRsZSc6XG4gICAgICAgICAgYVZhbHVlID0gYS50aXRsZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGJWYWx1ZSA9IGIudGl0bGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndXBsb2FkZXInOlxuICAgICAgICAgIGFWYWx1ZSA9IGEudXBsb2FkZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBiVmFsdWUgPSBiLnVwbG9hZGVyLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3Vwdm90ZXMnOlxuICAgICAgICAgIGFWYWx1ZSA9IGEudXB2b3RlcztcbiAgICAgICAgICBiVmFsdWUgPSBiLnVwdm90ZXM7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3ZpZXdDb3VudCc6XG4gICAgICAgICAgYVZhbHVlID0gYS52aWV3Q291bnQ7XG4gICAgICAgICAgYlZhbHVlID0gYi52aWV3Q291bnQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYVZhbHVlID0gbmV3IERhdGUoYS5jcmVhdGVkQXQpO1xuICAgICAgICAgIGJWYWx1ZSA9IG5ldyBEYXRlKGIuY3JlYXRlZEF0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHNvcnRPcmRlciA9PT0gJ2FzYycpIHtcbiAgICAgICAgcmV0dXJuIGFWYWx1ZSA+IGJWYWx1ZSA/IDEgOiAtMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhVmFsdWUgPCBiVmFsdWUgPyAxIDogLTE7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgcGFnaW5hdGlvblxuICAgIGNvbnN0IHRvdGFsSXRlbXMgPSBmaWx0ZXJlZEl0ZW1zLmxlbmd0aDtcbiAgICBjb25zdCB0b3RhbFBhZ2VzID0gTWF0aC5jZWlsKHRvdGFsSXRlbXMgLyBsaW1pdCk7XG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IChwYWdlIC0gMSkgKiBsaW1pdDtcbiAgICBjb25zdCBlbmRJbmRleCA9IHN0YXJ0SW5kZXggKyBsaW1pdDtcbiAgICBjb25zdCBwYWdpbmF0ZWRJdGVtcyA9IGZpbHRlcmVkSXRlbXMuc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpO1xuXG4gICAgLy8gUmV0dXJuIHBhZ2luYXRlZCByZXN1bHRzIHdpdGggbWV0YWRhdGFcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgaXRlbXM6IHBhZ2luYXRlZEl0ZW1zLFxuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBjdXJyZW50UGFnZTogcGFnZSxcbiAgICAgICAgdG90YWxQYWdlcyxcbiAgICAgICAgdG90YWxJdGVtcyxcbiAgICAgICAgaXRlbXNQZXJQYWdlOiBsaW1pdCxcbiAgICAgICAgaGFzTmV4dFBhZ2U6IHBhZ2UgPCB0b3RhbFBhZ2VzLFxuICAgICAgICBoYXNQcmV2UGFnZTogcGFnZSA+IDFcbiAgICAgIH0sXG4gICAgICBmaWx0ZXJzOiB7XG4gICAgICAgIHNlYXJjaCxcbiAgICAgICAgc29ydEJ5LFxuICAgICAgICBzb3J0T3JkZXIsXG4gICAgICAgIGRhdGVGaWx0ZXIsXG4gICAgICAgIGRhdGVSYW5nZUVuZFxuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0dhbGxlcnkgR0VUIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICBjb25zdCBmZWF0dXJlID0gc2VhcmNoUGFyYW1zLmdldCgnZmVhdHVyZScpO1xuXG4gICAgLy8gSGFuZGxlIGRpZmZlcmVudCBQT1NUIGZlYXR1cmVzXG4gICAgaWYgKGZlYXR1cmUgPT09ICd2b3RlJykge1xuICAgICAgY29uc3QgeyBnYWxsZXJ5SXRlbUlkLCB1c2VySWQsIHZvdGVUeXBlIH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgICAgaWYgKCFnYWxsZXJ5SXRlbUlkIHx8ICF1c2VySWQgfHwgIXZvdGVUeXBlKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHMnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBleGlzdGluZyB2b3RlXG4gICAgICBjb25zdCBleGlzdGluZ1ZvdGVJbmRleCA9IHZvdGVzLmZpbmRJbmRleCh2ID0+IHYuZ2FsbGVyeUl0ZW1JZCA9PT0gZ2FsbGVyeUl0ZW1JZCAmJiB2LnVzZXJJZCA9PT0gdXNlcklkKTtcbiAgICAgIGlmIChleGlzdGluZ1ZvdGVJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdWb3RlID0gdm90ZXNbZXhpc3RpbmdWb3RlSW5kZXhdO1xuICAgICAgICB2b3Rlcy5zcGxpY2UoZXhpc3RpbmdWb3RlSW5kZXgsIDEpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBnYWxsZXJ5IGl0ZW0gdm90ZSBjb3VudHNcbiAgICAgICAgY29uc3QgaXRlbSA9IGdhbGxlcnlJdGVtcy5maW5kKGkgPT4gaS5pZCA9PT0gZ2FsbGVyeUl0ZW1JZCk7XG4gICAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgICAgaWYgKGV4aXN0aW5nVm90ZS52b3RlVHlwZSA9PT0gJ3Vwdm90ZScpIHtcbiAgICAgICAgICAgIGl0ZW0udXB2b3RlcyA9IE1hdGgubWF4KDAsIGl0ZW0udXB2b3RlcyAtIDEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpdGVtLmRvd252b3RlcyA9IE1hdGgubWF4KDAsIGl0ZW0uZG93bnZvdGVzIC0gMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgc2FtZSB2b3RlIHR5cGUsIGp1c3QgcmVtb3ZlICh0b2dnbGUgb2ZmKVxuICAgICAgICBpZiAoZXhpc3RpbmdWb3RlLnZvdGVUeXBlID09PSB2b3RlVHlwZSkge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIHZvdGU6IG51bGwgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQWRkIG5ldyB2b3RlXG4gICAgICBjb25zdCBuZXdWb3RlOiBHYWxsZXJ5Vm90ZSA9IHtcbiAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgZ2FsbGVyeUl0ZW1JZCxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICB2b3RlVHlwZTogdm90ZVR5cGUgYXMgJ3Vwdm90ZScgfCAnZG93bnZvdGUnLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcblxuICAgICAgdm90ZXMucHVzaChuZXdWb3RlKTtcblxuICAgICAgLy8gVXBkYXRlIGdhbGxlcnkgaXRlbSB2b3RlIGNvdW50c1xuICAgICAgY29uc3QgaXRlbSA9IGdhbGxlcnlJdGVtcy5maW5kKGkgPT4gaS5pZCA9PT0gZ2FsbGVyeUl0ZW1JZCk7XG4gICAgICBpZiAoaXRlbSkge1xuICAgICAgICBpZiAodm90ZVR5cGUgPT09ICd1cHZvdGUnKSB7XG4gICAgICAgICAgaXRlbS51cHZvdGVzKys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbS5kb3dudm90ZXMrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCB2b3RlOiBuZXdWb3RlIH0pO1xuICAgIH1cblxuICAgIGlmIChmZWF0dXJlID09PSAnZmF2b3JpdGUnKSB7XG4gICAgICBjb25zdCB7IGdhbGxlcnlJdGVtSWQsIHVzZXJJZCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICAgIGlmICghZ2FsbGVyeUl0ZW1JZCB8fCAhdXNlcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHMnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIGFscmVhZHkgZmF2b3JpdGVkXG4gICAgICBjb25zdCBleGlzdGluZ0Zhdm9yaXRlSW5kZXggPSBmYXZvcml0ZXMuZmluZEluZGV4KGYgPT4gZi5nYWxsZXJ5SXRlbUlkID09PSBnYWxsZXJ5SXRlbUlkICYmIGYudXNlcklkID09PSB1c2VySWQpO1xuXG4gICAgICBpZiAoZXhpc3RpbmdGYXZvcml0ZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAvLyBSZW1vdmUgZmF2b3JpdGUgKHRvZ2dsZSBvZmYpXG4gICAgICAgIGZhdm9yaXRlcy5zcGxpY2UoZXhpc3RpbmdGYXZvcml0ZUluZGV4LCAxKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgaXNGYXZvcml0ZWQ6IGZhbHNlIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQWRkIGZhdm9yaXRlXG4gICAgICAgIGNvbnN0IG5ld0Zhdm9yaXRlOiBHYWxsZXJ5RmF2b3JpdGUgPSB7XG4gICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICBnYWxsZXJ5SXRlbUlkLFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9O1xuXG4gICAgICAgIGZhdm9yaXRlcy5wdXNoKG5ld0Zhdm9yaXRlKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgaXNGYXZvcml0ZWQ6IHRydWUgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZlYXR1cmUgPT09ICdjb21tZW50Jykge1xuICAgICAgY29uc3QgeyBnYWxsZXJ5SXRlbUlkLCB1c2VySWQsIHVzZXJOYW1lLCBjb250ZW50IH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgICAgaWYgKCFnYWxsZXJ5SXRlbUlkIHx8ICF1c2VySWQgfHwgIXVzZXJOYW1lIHx8ICFjb250ZW50Py50cmltKCkpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkcycgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV3Q29tbWVudDogR2FsbGVyeUNvbW1lbnQgPSB7XG4gICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgIGdhbGxlcnlJdGVtSWQsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdXNlck5hbWUsXG4gICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQudHJpbSgpLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcblxuICAgICAgY29tbWVudHMucHVzaChuZXdDb21tZW50KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGNvbW1lbnQ6IG5ld0NvbW1lbnQgfSk7XG4gICAgfVxuXG4gICAgaWYgKGZlYXR1cmUgPT09ICdzZWFyY2gtaGlzdG9yeScpIHtcbiAgICAgIGNvbnN0IHsgdXNlcklkLCBzZWFyY2hUZXJtIH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgICAgaWYgKCF1c2VySWQgfHwgIXNlYXJjaFRlcm0/LnRyaW0oKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ01pc3NpbmcgcmVxdWlyZWQgZmllbGRzJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBSZW1vdmUgZXhpc3Rpbmcgc2VhcmNoIHRlcm0gaWYgaXQgZXhpc3RzXG4gICAgICBjb25zdCBleGlzdGluZ0luZGV4ID0gc2VhcmNoSGlzdG9yeUl0ZW1zLmZpbmRJbmRleChzID0+IHMudXNlcklkID09PSB1c2VySWQgJiYgcy5zZWFyY2hUZXJtID09PSBzZWFyY2hUZXJtLnRyaW0oKSk7XG4gICAgICBpZiAoZXhpc3RpbmdJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgc2VhcmNoSGlzdG9yeUl0ZW1zLnNwbGljZShleGlzdGluZ0luZGV4LCAxKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIG5ldyBzZWFyY2ggaGlzdG9yeSBpdGVtXG4gICAgICBjb25zdCBuZXdTZWFyY2hIaXN0b3J5OiBTZWFyY2hIaXN0b3J5ID0ge1xuICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHNlYXJjaFRlcm06IHNlYXJjaFRlcm0udHJpbSgpLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcblxuICAgICAgc2VhcmNoSGlzdG9yeUl0ZW1zLnVuc2hpZnQobmV3U2VhcmNoSGlzdG9yeSk7IC8vIEFkZCB0byBiZWdpbm5pbmdcblxuICAgICAgLy8gS2VlcCBvbmx5IGxhc3QgMjAgc2VhcmNoZXMgcGVyIHVzZXJcbiAgICAgIGNvbnN0IHVzZXJTZWFyY2hlcyA9IHNlYXJjaEhpc3RvcnlJdGVtcy5maWx0ZXIocyA9PiBzLnVzZXJJZCA9PT0gdXNlcklkKTtcbiAgICAgIGlmICh1c2VyU2VhcmNoZXMubGVuZ3RoID4gMjApIHtcbiAgICAgICAgY29uc3Qgb2xkZXN0U2VhcmNoSW5kZXggPSBzZWFyY2hIaXN0b3J5SXRlbXMuZmluZEluZGV4KHMgPT4gcy5pZCA9PT0gdXNlclNlYXJjaGVzW3VzZXJTZWFyY2hlcy5sZW5ndGggLSAxXS5pZCk7XG4gICAgICAgIGlmIChvbGRlc3RTZWFyY2hJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBzZWFyY2hIaXN0b3J5SXRlbXMuc3BsaWNlKG9sZGVzdFNlYXJjaEluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBzZWFyY2hIaXN0b3J5OiBuZXdTZWFyY2hIaXN0b3J5IH0pO1xuICAgIH1cblxuICAgIC8vIFJlZ3VsYXIgZ2FsbGVyeSBpdGVtIHVwbG9hZFxuICAgIGNvbnN0IHsgdHlwZSwgdXJsLCB0aXRsZSwgZGVzY3JpcHRpb24sIHRhZ3MsIHVwbG9hZGVyTmFtZSwgdXBsb2FkZXJJZCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICBpZiAoIXR5cGUgfHwgIXVybCB8fCAhdGl0bGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHMnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gUHJvY2VzcyB0YWdzIGlmIHByb3ZpZGVkXG4gICAgbGV0IHByb2Nlc3NlZFRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgaWYgKHRhZ3MgJiYgdHlwZW9mIHRhZ3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICBwcm9jZXNzZWRUYWdzID0gdGFnc1xuICAgICAgICAuc3BsaXQoJywnKVxuICAgICAgICAubWFwKHRhZyA9PiB0YWcudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKHRhZyA9PiB0YWcubGVuZ3RoID4gMClcbiAgICAgICAgLnNsaWNlKDAsIDUpOyAvLyBMaW1pdCB0byA1IHRhZ3NcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSB0aHVtYm5haWwgZm9yIHZpZGVvIFVSTHNcbiAgICBsZXQgdGh1bWJuYWlsID0gJyc7XG4gICAgaWYgKHR5cGUgPT09ICd2aWRlbycpIHtcbiAgICAgIHRodW1ibmFpbCA9IGdlbmVyYXRlVmlkZW9UaHVtYm5haWwodXJsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGh1bWJuYWlsID0gdXJsOyAvLyBGb3IgaW1hZ2VzLCB1c2UgdGhlIGltYWdlIGl0c2VsZiBhcyB0aHVtYm5haWxcbiAgICB9XG5cbiAgICAvLyBGb3JtYXQgdGhlIHVwbG9hZGVyIG5hbWVcbiAgICBsZXQgZm9ybWF0dGVkVXBsb2FkZXJOYW1lID0gdXBsb2FkZXJOYW1lIHx8ICdBbm9ueW1vdXMgQ2FwdGFpbic7XG4gICAgaWYgKHVwbG9hZGVyTmFtZSAmJiAhdXBsb2FkZXJOYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NhcHRhaW4nKSkge1xuICAgICAgZm9ybWF0dGVkVXBsb2FkZXJOYW1lID0gYCR7dXBsb2FkZXJOYW1lfWA7XG4gICAgfVxuXG4gICAgY29uc3QgbmV3SXRlbSA9IGNyZWF0ZUdhbGxlcnlJdGVtKHtcbiAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICB0eXBlLFxuICAgICAgdXJsLFxuICAgICAgdGh1bWJuYWlsLFxuICAgICAgdGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICB1cGxvYWRlcjogZm9ybWF0dGVkVXBsb2FkZXJOYW1lLFxuICAgICAgdXBsb2FkZXJJZDogdXBsb2FkZXJJZCB8fCAnZGV2LXVzZXInLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB0YWdzOiBwcm9jZXNzZWRUYWdzLFxuICAgICAgdXB2b3RlczogMCxcbiAgICAgIGRvd252b3RlczogMCxcbiAgICAgIHZpZXdDb3VudDogMCxcbiAgICB9KTtcblxuICAgIGdhbGxlcnlJdGVtcy51bnNoaWZ0KG5ld0l0ZW0pOyAvLyBBZGQgdG8gYmVnaW5uaW5nIG9mIGFycmF5XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBpdGVtOiBuZXdJdGVtIH0sIHsgc3RhdHVzOiAyMDEgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR2FsbGVyeSBQT1NUIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IGl0ZW1JZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2lkJyk7XG5cbiAgICBpZiAoIWl0ZW1JZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdJdGVtIElEIGlzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGl0ZW1JbmRleCA9IGdhbGxlcnlJdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLmlkID09PSBpdGVtSWQpO1xuXG4gICAgaWYgKGl0ZW1JbmRleCA9PT0gLTEpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnSXRlbSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgfVxuXG4gICAgZ2FsbGVyeUl0ZW1zLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuXG4gICAgLy8gQWxzbyByZW1vdmUgcmVsYXRlZCBjb21tZW50cywgdm90ZXMsIGFuZCBmYXZvcml0ZXNcbiAgICBjb25zdCBjb21tZW50c1RvUmVtb3ZlID0gY29tbWVudHMuZmlsdGVyKGMgPT4gYy5nYWxsZXJ5SXRlbUlkID09PSBpdGVtSWQpO1xuICAgIGNvbW1lbnRzVG9SZW1vdmUuZm9yRWFjaChjb21tZW50ID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gY29tbWVudHMuaW5kZXhPZihjb21tZW50KTtcbiAgICAgIGlmIChpbmRleCA+IC0xKSBjb21tZW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH0pO1xuXG4gICAgY29uc3Qgdm90ZXNUb1JlbW92ZSA9IHZvdGVzLmZpbHRlcih2ID0+IHYuZ2FsbGVyeUl0ZW1JZCA9PT0gaXRlbUlkKTtcbiAgICB2b3Rlc1RvUmVtb3ZlLmZvckVhY2godm90ZSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHZvdGVzLmluZGV4T2Yodm90ZSk7XG4gICAgICBpZiAoaW5kZXggPiAtMSkgdm90ZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGZhdm9yaXRlc1RvUmVtb3ZlID0gZmF2b3JpdGVzLmZpbHRlcihmID0+IGYuZ2FsbGVyeUl0ZW1JZCA9PT0gaXRlbUlkKTtcbiAgICBmYXZvcml0ZXNUb1JlbW92ZS5mb3JFYWNoKGZhdm9yaXRlID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gZmF2b3JpdGVzLmluZGV4T2YoZmF2b3JpdGUpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIGZhdm9yaXRlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWVzc2FnZTogJ0l0ZW0gZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR2FsbGVyeSBERUxFVEUgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlVmlkZW9UaHVtYm5haWwodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAvLyBZb3VUdWJlIHRodW1ibmFpbCBleHRyYWN0aW9uXG4gIGNvbnN0IHlvdXR1YmVNYXRjaCA9IHVybC5tYXRjaCgvKD86eW91dHViZVxcLmNvbVxcL3dhdGNoXFw/dj18eW91dHVcXC5iZVxcLykoW14mXFxuPyNdKykvKTtcbiAgaWYgKHlvdXR1YmVNYXRjaCkge1xuICAgIHJldHVybiBgaHR0cHM6Ly9pbWcueW91dHViZS5jb20vdmkvJHt5b3V0dWJlTWF0Y2hbMV19L21heHJlc2RlZmF1bHQuanBnYDtcbiAgfVxuXG4gIC8vIFZpbWVvIHRodW1ibmFpbCAod291bGQgbmVlZCBBUEkgY2FsbCBpbiBwcm9kdWN0aW9uKVxuICBjb25zdCB2aW1lb01hdGNoID0gdXJsLm1hdGNoKC92aW1lb1xcLmNvbVxcLyhcXGQrKS8pO1xuICBpZiAodmltZW9NYXRjaCkge1xuICAgIHJldHVybiBgaHR0cHM6Ly92dW1ibmFpbC5jb20vJHt2aW1lb01hdGNoWzFdfS5qcGdgO1xuICB9XG5cbiAgLy8gRGVmYXVsdCB2aWRlbyBwbGFjZWhvbGRlclxuICByZXR1cm4gJy9hcGkvcGxhY2Vob2xkZXIvdmlkZW8tdGh1bWJuYWlsJztcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjcmVhdGVHYWxsZXJ5SXRlbSIsIml0ZW0iLCJ1cHZvdGVzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZG93bnZvdGVzIiwidmlld0NvdW50IiwidGFncyIsImdhbGxlcnlJdGVtcyIsImlkIiwidHlwZSIsInVybCIsInRodW1ibmFpbCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ1cGxvYWRlciIsInVwbG9hZGVySWQiLCJjcmVhdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJjb21tZW50cyIsInZvdGVzIiwiZmF2b3JpdGVzIiwic2VhcmNoSGlzdG9yeUl0ZW1zIiwiR0VUIiwicmVxdWVzdCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsImZlYXR1cmUiLCJnZXQiLCJnYWxsZXJ5SXRlbUlkIiwidXNlcklkIiwiaXRlbUNvbW1lbnRzIiwiZmlsdGVyIiwiYyIsImpzb24iLCJ1c2VyVm90ZSIsImZpbmQiLCJ2Iiwidm90ZSIsImlzRmF2b3JpdGVkIiwic29tZSIsImYiLCJ1c2VyRmF2b3JpdGVzIiwidXNlclNlYXJjaEhpc3RvcnkiLCJzIiwic29ydCIsImEiLCJiIiwiZ2V0VGltZSIsInNsaWNlIiwic2VhcmNoSGlzdG9yeSIsInBhZ2UiLCJwYXJzZUludCIsImxpbWl0Iiwic29ydEJ5Iiwic29ydE9yZGVyIiwic2VhcmNoIiwiZGF0ZUZpbHRlciIsImRhdGVSYW5nZUVuZCIsImZpbHRlcmVkSXRlbXMiLCJzZWFyY2hMb3dlciIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJ0YWciLCJpdGVtRGF0ZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJzZXRIb3VycyIsImZpbHRlckRhdGUiLCJuZXh0RGF5Iiwic2V0RGF0ZSIsImdldERhdGUiLCJhVmFsdWUiLCJiVmFsdWUiLCJ0b3RhbEl0ZW1zIiwibGVuZ3RoIiwidG90YWxQYWdlcyIsImNlaWwiLCJzdGFydEluZGV4IiwiZW5kSW5kZXgiLCJwYWdpbmF0ZWRJdGVtcyIsIml0ZW1zIiwicGFnaW5hdGlvbiIsImN1cnJlbnRQYWdlIiwiaXRlbXNQZXJQYWdlIiwiaGFzTmV4dFBhZ2UiLCJoYXNQcmV2UGFnZSIsImZpbHRlcnMiLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiLCJQT1NUIiwidm90ZVR5cGUiLCJleGlzdGluZ1ZvdGVJbmRleCIsImZpbmRJbmRleCIsImV4aXN0aW5nVm90ZSIsInNwbGljZSIsImkiLCJtYXgiLCJzdWNjZXNzIiwibmV3Vm90ZSIsIm5vdyIsInRvU3RyaW5nIiwicHVzaCIsImV4aXN0aW5nRmF2b3JpdGVJbmRleCIsIm5ld0Zhdm9yaXRlIiwidXNlck5hbWUiLCJjb250ZW50IiwidHJpbSIsIm5ld0NvbW1lbnQiLCJjb21tZW50Iiwic2VhcmNoVGVybSIsImV4aXN0aW5nSW5kZXgiLCJuZXdTZWFyY2hIaXN0b3J5IiwidW5zaGlmdCIsInVzZXJTZWFyY2hlcyIsIm9sZGVzdFNlYXJjaEluZGV4IiwidXBsb2FkZXJOYW1lIiwicHJvY2Vzc2VkVGFncyIsInNwbGl0IiwibWFwIiwiZ2VuZXJhdGVWaWRlb1RodW1ibmFpbCIsImZvcm1hdHRlZFVwbG9hZGVyTmFtZSIsIm5ld0l0ZW0iLCJERUxFVEUiLCJpdGVtSWQiLCJpdGVtSW5kZXgiLCJjb21tZW50c1RvUmVtb3ZlIiwiZm9yRWFjaCIsImluZGV4IiwiaW5kZXhPZiIsInZvdGVzVG9SZW1vdmUiLCJmYXZvcml0ZXNUb1JlbW92ZSIsImZhdm9yaXRlIiwibWVzc2FnZSIsInlvdXR1YmVNYXRjaCIsIm1hdGNoIiwidmltZW9NYXRjaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/gallery/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgallery%2Froute&page=%2Fapi%2Fgallery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgallery%2Froute.ts&appDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ctijer%5COneDrive%5CDocuments%5Ckrakengaming%5Capps%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();