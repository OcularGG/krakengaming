(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7964],{8665:(e,t,a)=>{Promise.resolve().then(a.bind(a,7059))},7059:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(7573),l=a(7653),i=a(140),r=a(7754),n=a(7659);let c=e=>{let{src:t,alt:a,className:i="",onError:r}=e,[n,c]=(0,l.useState)(null),[d,o]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let e=new Image;e.onload=()=>{c(t),o(!1)},e.onerror=()=>{o(!1),r&&r()},e.src=t},[t,r]),(0,s.jsxs)("div",{className:"".concat(i," relative"),children:[d&&(0,s.jsx)("div",{className:"absolute inset-0 bg-navy-dark/10 animate-pulse flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-navy-dark",children:"⚓"})}),n&&(0,s.jsx)("img",{src:n,alt:a,className:i,onLoad:()=>o(!1),onError:r}),!n&&!d&&(0,s.jsx)("div",{className:"".concat(i," bg-navy-dark/5 flex items-center justify-center"),children:(0,s.jsx)("div",{className:"text-navy-dark/50",children:"Failed to load"})})]})};function d(){let{data:e,status:t}=(0,i.k)(),a=(0,r.useRouter)(),[d,o]=(0,l.useState)([]),[u,m]=(0,l.useState)(!0),[x,h]=(0,l.useState)(null);(0,l.useEffect)(()=>{"loading"===t||e||a.push("/gallery")},[e,t,a]);let v=(0,l.useCallback)(async()=>{if(null==e?void 0:e.user){m(!0);try{let t=await fetch("/api/gallery?feature=favorites&userId=".concat(e.user.id||"dev-user")),a=await t.json();if(a.favorites&&a.favorites.length>0){let e=await fetch("/api/gallery?limit=1000"),t=await e.json(),s=a.favorites.map(e=>e.galleryItemId),l=t.items.filter(e=>s.includes(e.id)).sort((e,t)=>{let s=a.favorites.find(t=>t.galleryItemId===e.id),l=a.favorites.find(e=>e.galleryItemId===t.id);return new Date((null==l?void 0:l.createdAt)||0).getTime()-new Date((null==s?void 0:s.createdAt)||0).getTime()});o(l)}else o([])}catch(e){console.error("Failed to fetch favorites:",e),o([])}finally{m(!1)}}},[e]);(0,l.useEffect)(()=>{e&&v()},[e,v]);let f=async t=>{if(null==e?void 0:e.user)try{(await fetch("/api/gallery?feature=favorite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({galleryItemId:t,userId:e.user.id||"dev-user"})})).ok&&o(e=>e.filter(e=>e.id!==t))}catch(e){console.error("Failed to remove favorite:",e)}},y=e=>new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),b=e=>"".concat(window.location.origin,"/gallery/").concat(e.id),j=async e=>{let t=b(e);if(navigator.share)try{await navigator.share({title:e.title,text:e.description,url:t})}catch(e){await navigator.clipboard.writeText(t),alert("Share link copied to clipboard!")}else await navigator.clipboard.writeText(t),alert("Share link copied to clipboard!")};return"loading"===t?(0,s.jsx)("div",{className:"min-h-screen bg-sail-white pt-24 pb-12",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("div",{className:"text-navy-dark",children:"Loading..."})})})}):e?(0,s.jsx)("div",{className:"min-h-screen bg-sail-white pt-24 pb-12",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-navy-dark mb-4",style:{fontFamily:"Cinzel, serif"},children:"My Favorites"}),(0,s.jsx)("p",{className:"text-lg text-navy-dark/70",children:"Your collection of favorited gallery items"}),(0,s.jsx)(n.default,{href:"/gallery",className:"inline-block mt-4 text-brass hover:text-brass-bright transition-colors duration-200",style:{fontFamily:"Cinzel, serif"},children:"← Back to Gallery"})]}),u?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("div",{className:"text-navy-dark",children:"Loading your favorites..."})}):0===d.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-navy-dark/70 mb-4",children:"You haven't favorited any items yet."}),(0,s.jsx)(n.default,{href:"/gallery",className:"neo-brutal-button bg-brass text-navy-dark px-6 py-3",style:{fontFamily:"Cinzel, serif"},children:"Browse Gallery"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:d.map(e=>(0,s.jsxs)("div",{className:"neo-brutal-box p-4 bg-sail-white hover:shadow-lg transition-shadow duration-200",children:[(0,s.jsx)("div",{className:"cursor-pointer",onClick:()=>h({item:e,type:e.type}),children:"image"===e.type?(0,s.jsx)(c,{src:e.thumbnail||e.url,alt:e.title,className:"w-full h-48 object-cover mb-3"}):(0,s.jsxs)("div",{className:"relative w-full h-48 mb-3",children:[(0,s.jsx)(c,{src:e.thumbnail||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMmEyYTJhIi8+CjxjaXJjbGUgY3g9IjE1MCIgY3k9IjEwMCIgcj0iMjAiIGZpbGw9IiM0ZDRkNGQiLz4KPC9zdmc+",alt:e.title,className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:(0,s.jsx)("div",{className:"w-12 h-12 bg-brass rounded-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-navy-dark",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M8 5v14l11-7z"})})})})]})}),(0,s.jsx)("h3",{className:"font-semibold text-navy-dark mb-2 line-clamp-2",style:{fontFamily:"Cinzel, serif"},children:e.title}),(0,s.jsx)("p",{className:"text-sm text-navy-dark/70 mb-3 line-clamp-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-navy-dark/60 mb-3",children:[(0,s.jsxs)("span",{children:["By ",e.uploader]}),(0,s.jsx)("span",{children:y(e.createdAt)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-navy-dark/60 mb-3",children:[(0,s.jsxs)("span",{children:["▲ ",e.upvotes," upvotes"]}),(0,s.jsxs)("span",{children:[e.viewCount," views"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>j(e),className:"flex-1 neo-brutal-button bg-brass/20 text-navy-dark py-2 text-sm hover:bg-brass/40 transition-colors duration-200",children:"Share"}),(0,s.jsx)("button",{onClick:()=>f(e.id),className:"flex-1 neo-brutal-button bg-red-100 text-red-700 py-2 text-sm hover:bg-red-200 transition-colors duration-200",children:"Remove"})]})]},e.id))}),x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"relative max-w-4xl max-h-full",children:[(0,s.jsx)("button",{onClick:()=>h(null),className:"absolute top-4 right-4 z-10 w-10 h-10 bg-black/50 hover:bg-black/70 text-white rounded-full flex items-center justify-center transition-colors duration-200",children:"✕"}),"image"===x.type?(0,s.jsx)("img",{src:x.item.url,alt:x.item.title,className:"max-w-full max-h-full object-contain"}):(0,s.jsx)("video",{src:x.item.url,controls:!0,className:"max-w-full max-h-full",autoPlay:!0})]})})]})}):null}},140:(e,t,a)=>{"use strict";a.d(t,{k:()=>i});var s=a(4785),l=a(7653);function i(){let e=(0,s.kP)(),[t,a]=(0,l.useState)(null);return(0,l.useEffect)(()=>{},[]),e}},7659:(e,t,a)=>{"use strict";a.d(t,{default:()=>l.a});var s=a(5469),l=a.n(s)},7754:(e,t,a)=>{"use strict";var s=a(534);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[4785,5469,1174,8765,1744],()=>t(8665)),_N_E=e.O()}]);