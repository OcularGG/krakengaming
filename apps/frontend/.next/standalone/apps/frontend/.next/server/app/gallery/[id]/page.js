(()=>{var e={};e.id=7256,e.ids=[7256],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},3281:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d});var s=a(329),r=a(7868),i=a(6041),l=a.n(i),n=a(9962),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["gallery",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,2203)),"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\gallery\\[id]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,154))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,6560)),"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,6833)),"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,154))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\gallery\\[id]\\page.tsx"],m={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/gallery/[id]/page",pathname:"/gallery/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2479:(e,t,a)=>{Promise.resolve().then(a.bind(a,2993))},2993:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5697),r=a(6336),i=a(1043),l=a(718),n=a(649);let o=({src:e,alt:t,className:a="",onError:i})=>{let[l,n]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let t=new Image;t.onload=()=>{n(e),d(!1)},t.onerror=()=>{d(!1),i&&i()},t.src=e},[e,i]),(0,s.jsxs)("div",{className:`${a} relative`,children:[o&&(0,s.jsx)("div",{className:"absolute inset-0 bg-navy-dark/10 animate-pulse flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-navy-dark",children:"⚓"})}),l&&(0,s.jsx)("img",{src:l,alt:t,className:a,onLoad:()=>d(!1),onError:i}),!l&&!o&&(0,s.jsx)("div",{className:`${a} bg-navy-dark/5 flex items-center justify-center`,children:(0,s.jsx)("div",{className:"text-navy-dark/50",children:"Failed to load"})})]})};function d(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{data:a}=(0,l.k)(),[d,c]=(0,r.useState)(null),[m,x]=(0,r.useState)(!0),[u,p]=(0,r.useState)([]),[h,g]=(0,r.useState)(""),[v,y]=(0,r.useState)(null),[b,f]=(0,r.useState)(!1),[j,N]=(0,r.useState)(0),k=e.id,w=(0,r.useCallback)(async()=>{x(!0);try{let e=await fetch("/api/gallery?limit=1000"),s=(await e.json()).items.find(e=>e.id===k);if(!s){t.push("/gallery");return}c(s);let r=await fetch(`/api/gallery?feature=comments&galleryItemId=${k}`),i=await r.json();if(p(i.comments||[]),a?.user){let e=a.user.id||"dev-user",t=await fetch(`/api/gallery?feature=votes&galleryItemId=${k}&userId=${e}`),s=await t.json();y(s.vote?.voteType||null);let r=await fetch(`/api/gallery?feature=favorites&userId=${e}&galleryItemId=${k}`),i=await r.json();f(i.isFavorited||!1)}}catch(e){console.error("Failed to fetch item:",e),t.push("/gallery")}finally{x(!1)}},[k,a,t]),C=async e=>{if(a?.user&&d)try{(await fetch("/api/gallery?feature=vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({galleryItemId:d.id,userId:a.user.id||"dev-user",voteType:e})})).ok&&(y(t=>t===e?null:e),w())}catch(e){console.error("Failed to vote:",e)}},I=async()=>{if(a?.user&&d)try{(await fetch("/api/gallery?feature=favorite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({galleryItemId:d.id,userId:a.user.id||"dev-user"})})).ok&&f(e=>!e)}catch(e){console.error("Failed to favorite:",e)}},P=async()=>{if(a?.user&&d&&h.trim())try{if((await fetch("/api/gallery?feature=comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({galleryItemId:d.id,userId:a.user.id||"dev-user",userName:a.user.name||"Anonymous Captain",content:h.trim()})})).ok){g("");let e=await fetch(`/api/gallery?feature=comments&galleryItemId=${d.id}`),t=await e.json();p(t.comments||[])}}catch(e){console.error("Failed to comment:",e)}},S=async()=>{if(!d)return;let e=window.location.href;if(navigator.share)try{await navigator.share({title:d.title,text:d.description,url:e})}catch(t){await navigator.clipboard.writeText(e),alert("Share link copied to clipboard!")}else await navigator.clipboard.writeText(e),alert("Share link copied to clipboard!")},D=e=>new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return m?(0,s.jsx)("div",{className:"min-h-screen bg-sail-white pt-24 pb-12",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("div",{className:"text-navy-dark",children:"Loading..."})})})}):d?(0,s.jsx)("div",{className:"min-h-screen bg-sail-white pt-24 pb-12",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)(n.default,{href:"/gallery",className:"inline-block mb-6 text-brass hover:text-brass-bright transition-colors duration-200",style:{fontFamily:"Cinzel, serif"},children:"← Back to Gallery"}),(0,s.jsxs)("div",{className:"neo-brutal-box p-6 bg-sail-white",children:[(0,s.jsx)("div",{className:"mb-6",children:"collection"===d.type&&d.images?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"relative aspect-video bg-navy-dark/10 flex items-center justify-center",children:[d.images.length>1&&(0,s.jsx)("button",{onClick:()=>{N(e=>e>0?e-1:d.images.length-1)},className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 neo-brutal-button bg-brass text-navy-dark w-12 h-12 flex items-center justify-center text-xl shadow-lg hover:bg-brass/80 transition-colors",title:"Previous image",children:"←"}),(0,s.jsx)(o,{src:d.images[j],alt:`${d.title} - Image ${j+1}`,className:"w-full max-h-96 object-contain mx-auto"}),d.images.length>1&&(0,s.jsx)("button",{onClick:()=>{N(e=>e<d.images.length-1?e+1:0)},className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 neo-brutal-button bg-brass text-navy-dark w-12 h-12 flex items-center justify-center text-xl shadow-lg hover:bg-brass/80 transition-colors",title:"Next image",children:"→"})]}),d.images.length>1&&(0,s.jsxs)("div",{className:"text-center mt-2 text-sm text-navy-dark/70",children:["Image ",j+1," of ",d.images.length]})]}):"image"===d.type?(0,s.jsx)(o,{src:d.url,alt:d.title,className:"w-full max-h-96 object-contain mx-auto"}):(0,s.jsx)("video",{src:d.url,controls:!0,className:"w-full max-h-96 mx-auto"})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-navy-dark mb-4",style:{fontFamily:"Cinzel, serif"},children:d.title}),(0,s.jsx)("p",{className:"text-navy-dark/70 mb-6",children:d.description}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between mb-6 text-sm text-navy-dark/60",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{children:["By ",d.uploader]}),(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("span",{children:D(d.createdAt)}),"collection"===d.type&&d.imageCount&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsxs)("span",{className:"text-brass",children:["\uD83D\uDCF8 ",d.imageCount," images"]})]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("span",{children:[d.viewCount," views"]})})]}),d.tags.length>0&&(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:d.tags.map((e,t)=>(0,s.jsxs)("span",{className:"neo-brutal-button bg-brass/20 text-navy-dark px-3 py-1 text-sm",children:["#",e]},t))})}),(0,s.jsxs)("div",{className:"flex gap-4 mb-8",children:[a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>C("upvote"),className:`neo-brutal-button px-4 py-2 ${"upvote"===v?"bg-green-200 text-green-800":"bg-sail-white text-navy-dark"}`,children:["▲ ",d.upvotes]}),(0,s.jsxs)("button",{onClick:()=>C("downvote"),className:`neo-brutal-button px-4 py-2 ${"downvote"===v?"bg-red-200 text-red-800":"bg-sail-white text-navy-dark"}`,children:["▼ ",d.downvotes]}),(0,s.jsxs)("button",{onClick:I,className:`neo-brutal-button px-4 py-2 ${b?"bg-red-200 text-red-800":"bg-sail-white text-navy-dark"}`,children:[b?"❤️":"\uD83E\uDD0D"," Favorite"]})]}),(0,s.jsx)("button",{onClick:S,className:"neo-brutal-button bg-brass text-navy-dark px-4 py-2",children:"Share"})]}),(0,s.jsxs)("div",{className:"border-t border-navy-dark/20 pt-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-navy-dark mb-4",style:{fontFamily:"Cinzel, serif"},children:["Comments (",u.length,")"]}),a?(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("textarea",{value:h,onChange:e=>g(e.target.value),placeholder:"Add a comment...",className:"w-full p-3 border-2 border-navy-dark text-navy-dark resize-none",rows:3}),(0,s.jsx)("button",{onClick:P,disabled:!h.trim(),className:"neo-brutal-button bg-brass text-navy-dark px-4 py-2 mt-2 disabled:opacity-50",children:"Post Comment"})]}):(0,s.jsx)("div",{className:"mb-6 p-4 bg-brass/10 border border-brass/20",children:(0,s.jsxs)("p",{className:"text-navy-dark",children:[(0,s.jsx)(n.default,{href:"/gallery",className:"text-brass hover:text-brass-bright",children:"Sign in"})," to leave a comment."]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[u.map(e=>(0,s.jsxs)("div",{className:"bg-sail-white/50 p-4 border border-navy-dark/10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"font-semibold text-navy-dark",style:{fontFamily:"Cinzel, serif"},children:e.userName}),(0,s.jsx)("span",{className:"text-sm text-navy-dark/60",children:D(e.createdAt)})]}),(0,s.jsx)("p",{className:"text-navy-dark",children:e.content})]},e.id)),0===u.length&&(0,s.jsx)("p",{className:"text-navy-dark/60 text-center py-8",children:"No comments yet. Be the first to share your thoughts!"})]})]})]})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-sail-white pt-24 pb-12",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-navy-dark",children:"Item not found"}),(0,s.jsx)(n.default,{href:"/gallery",className:"text-brass hover:text-brass-bright",children:"Back to Gallery"})]})})})}},2203:(e,t,a)=>{"use strict";a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>e});var r=a(1909);let e=(await (0,r.createProxy)(String.raw`C:\Users\tijer\OneDrive\Documents\krakengaming\apps\frontend\src\app\gallery\[id]\page.tsx`)).default;s()}catch(e){s(e)}},1)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[9769,869,3429],()=>a(3281));module.exports=s})();