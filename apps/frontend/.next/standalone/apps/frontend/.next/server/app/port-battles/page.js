(()=>{var e={};e.id=9239,e.ids=[9239],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},2484:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>c});var r=a(329),s=a(7868),n=a(6041),i=a.n(n),l=a(9962),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);a.d(t,d);let c=["",{children:["port-battles",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,561)),"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\port-battles\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,154))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,6560)),"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,6833)),"C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,154))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["C:\\Users\\tijer\\OneDrive\\Documents\\krakengaming\\apps\\frontend\\src\\app\\port-battles\\page.tsx"],m={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/port-battles/page",pathname:"/port-battles",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6116:(e,t,a)=>{Promise.resolve().then(a.bind(a,8338))},8338:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(5697),s=a(6336);let n=[{name:"Santisima",br:278},{name:"L'Ocean",br:239},{name:"Santa Ana",br:225},{name:"Victory",br:216},{name:"DLC Victory",br:224},{name:"Christian VII",br:164},{name:"Bucentaure",br:161},{name:"Redoutable",br:148},{name:"Implacable",br:163},{name:"St. Pavel",br:150},{name:"Bellona",br:134},{name:"3rd Rate (74)",br:132},{name:"Wasa",br:125},{name:"USS United States (previously Constitution)",br:96},{name:"Constitution (previously classic)",br:96},{name:"R\xe4ttvisan",br:107},{name:"Agamemnon",br:114},{name:"Leopard",br:95},{name:"Indefatigable",br:79},{name:"Ingermanland",br:111},{name:"Wapen von Hamburg III",br:120},{name:"Endymion",br:85},{name:"Trincomalee",br:87},{name:"Diana",br:78},{name:"L'Hermione",br:72},{name:"Santa Cecilia",br:72},{name:"Essex",br:71},{name:"Pirate Frigate(Cherubim)",br:67},{name:"Belle Poule",br:65},{name:"Frigate (Cherubim)",br:66},{name:"LGV Refit",br:40},{name:"Indiaman",br:37},{name:"Surprise",br:64},{name:"Renommee",br:38},{name:"Le Gros Ventre",br:28},{name:"Hercules",br:58},{name:"Rattlesnake Heavy",br:32},{name:"Pandora",br:65},{name:"Le Requin",br:30},{name:"Cerberus",br:33},{name:"Niagara",br:25},{name:"Mortar Brig",br:15},{name:"Prince de Neufchatel",br:25},{name:"Snow (Ontario)",br:27},{name:"Mercury",br:25},{name:"Rattlesnake",br:22},{name:"Navy Brig (Fair American)",br:22},{name:"Trader Snow",br:26},{name:"Brig (Fair American)",br:20},{name:"Pickle",br:15},{name:"Yacht",br:15},{name:"Privateer",br:15},{name:"Cutter (Alert)",br:15},{name:"Trader Lynx",br:13},{name:"Lynx",br:13},{name:"ADR",br:143},{name:"Duke Of Kent",br:353},{name:"San Pedro",br:164}],i=n.map(e=>e.name);function l({role:e,portBattleId:t,onClose:a,onSignUp:n}){let[l,d]=(0,s.useState)({ship:"",books:1,alternateShip:"",alternateBooks:1,willingToScreen:!1,comments:""});return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Sign Up for Role #",e.position]}),(0,r.jsxs)("form",{onSubmit:r=>{r.preventDefault(),n({portBattleId:t,roleId:e.id,...l}),a()},className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Primary Ship"}),(0,r.jsxs)("select",{value:l.ship,onChange:e=>d(t=>({...t,ship:e.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select a ship..."}),i.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Primary Books (1-5)"}),(0,r.jsx)("input",{type:"number",min:"1",max:"5",value:l.books,onChange:e=>d(t=>({...t,books:parseInt(e.target.value)})),className:"w-full p-2 border rounded-md",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Alternate Ship"}),(0,r.jsxs)("select",{value:l.alternateShip,onChange:e=>d(t=>({...t,alternateShip:e.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select alternate ship..."}),i.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Alternate Books (1-5)"}),(0,r.jsx)("input",{type:"number",min:"1",max:"5",value:l.alternateBooks,onChange:e=>d(t=>({...t,alternateBooks:parseInt(e.target.value)})),className:"w-full p-2 border rounded-md",required:!0})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"willingToScreen",checked:l.willingToScreen,onChange:e=>d(t=>({...t,willingToScreen:e.target.checked})),className:"mr-2"}),(0,r.jsx)("label",{htmlFor:"willingToScreen",className:"text-sm",children:"Willing to screen?"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Comments (optional)"}),(0,r.jsx)("textarea",{value:l.comments,onChange:e=>d(t=>({...t,comments:e.target.value})),className:"w-full p-2 border rounded-md",rows:3,placeholder:"Any additional comments..."})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,r.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Sign Up"}),(0,r.jsx)("button",{type:"button",onClick:a,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"})]})]})]})})}function d(){let[e,t]=(0,s.useState)([]),[a,i]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0),[o,m]=(0,s.useState)(null),[p,x]=(0,s.useState)(!1),h=async e=>{try{let r=await fetch("/api/port-battles?action=signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok){if(a){let e=await fetch(`/api/port-battles?id=${a.id}`),r=await e.json();i(r),t(e=>e.map(e=>e.id===r.id?r:e))}}else{let e=await r.json();alert(e.error||"Failed to sign up")}}catch(e){console.error("Error signing up:",e),alert("Failed to sign up")}},u=async(e,t)=>{if(a)try{if((await fetch(`/api/port-battles?id=${a.id}&action=approve-captain`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleId:e,approved:t})})).ok){let e=await fetch(`/api/port-battles?id=${a.id}`),t=await e.json();i(t)}}catch(e){console.error("Error updating approval:",e)}};if(d)return(0,r.jsx)("div",{className:"flex justify-center items-center min-h-64",children:"Loading..."});if(!a)return(0,r.jsx)("div",{className:"text-center py-8",children:"No port battles available"});let b=a.fleetCompositions.find(e=>e.isActive),g=a.brLimit-a.currentBR;return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Port Battles"}),e.length>1&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Port Battle:"}),(0,r.jsx)("select",{value:a.id,onChange:t=>{i(e.find(e=>e.id===t.target.value)||null)},className:"p-2 border rounded-md",children:e.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.port," - ",new Date(e.battleStartTimeUTC).toLocaleDateString()]},e.id))})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[(0,r.jsxs)("h2",{className:"text-2xl font-semibold mb-4",children:[a.port," Port Battle"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Meetup Time (UTC):"}),(0,r.jsx)("br",{}),new Date(a.meetupTimeUTC).toLocaleString()]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Battle Start (UTC):"}),(0,r.jsx)("br",{}),new Date(a.battleStartTimeUTC).toLocaleString()]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Water Type:"}),(0,r.jsx)("br",{}),a.waterType]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Meetup Location:"}),(0,r.jsx)("br",{}),a.meetupLocation]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"PB Commander:"}),(0,r.jsx)("br",{}),a.pbCommander]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"2IC Commander:"}),(0,r.jsx)("br",{}),a.secondInCommand]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"REQ Commander:"}),(0,r.jsx)("br",{}),a.reqCommander]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"BR Limit:"}),(0,r.jsx)("br",{}),a.brLimit]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Current BR:"}),(0,r.jsx)("br",{}),(0,r.jsxs)("span",{className:g<0?"text-red-600 font-bold":"text-green-600",children:[a.currentBR," / ",a.brLimit]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Remaining BR:"}),(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:g<0?"text-red-600 font-bold":"text-green-600",children:g})]})]})]}),a.fleetCompositions.length>1&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"flex border-b",children:a.fleetCompositions.map(e=>(0,r.jsx)("button",{onClick:()=>{},className:`px-4 py-2 border-b-2 ${e.isActive?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.name},e.id))})}),b&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-b",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:[b.name," - Sign Up Sheet"]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clan"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Captain"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ship"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"BR"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Books"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alt Ship"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alt Books"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Screen?"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comments"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.roles.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.position}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.clan||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.name||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.ship||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.ship?function(e){let t=n.find(t=>t.name===e);return t?.br||0}(e.captain.ship):"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.books||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.alternateShip||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.alternateBooks||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.captain?.willingToScreen?"Yes":"No"}),(0,r.jsx)("td",{className:"px-4 py-4 text-sm text-gray-900 max-w-xs truncate",children:e.captain?.comments||"-"}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:e.captain&&(0,r.jsx)("span",{className:`px-2 py-1 text-xs rounded-full ${"approved"===e.captain.status?"bg-green-100 text-green-800":"pending"===e.captain.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.captain.status})}),(0,r.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:e.captain?p&&"pending"===e.captain.status?(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("button",{onClick:()=>u(e.id,!0),className:"bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700",children:"✓"}),(0,r.jsx)("button",{onClick:()=>u(e.id,!1),className:"bg-red-600 text-white px-2 py-1 rounded text-xs hover:bg-red-700",children:"✗"})]}):null:(0,r.jsx)("button",{onClick:()=>m(e),className:"bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700",children:"Sign Up"})})]},e.id))})]})})]}),a.screeningFleets.length>0&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Screening Fleets"}),a.screeningFleets.map((e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow mb-4 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b",children:[(0,r.jsxs)("h4",{className:"text-lg font-medium",children:["Screening Fleet #",t+1," - ",e.type," (",e.nation,")"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Commander: ",e.commander]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Observation: ",e.observation]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Requirements: ",e.shipRequirements.join(", ")]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.captains.map((e,t)=>(0,r.jsxs)("div",{className:"border rounded p-3",children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:e.clan}),(0,r.jsx)("span",{className:`inline-block px-2 py-1 text-xs rounded-full mt-1 ${"approved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.status})]},t))}),(0,r.jsx)("button",{className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Sign Up for Screening"})]})]},e.id))]}),o&&(0,r.jsx)(l,{role:o,portBattleId:a.id,onClose:()=>m(null),onSignUp:h})]})}},561:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>e});var s=a(1909);let e=(await (0,s.createProxy)(String.raw`C:\Users\tijer\OneDrive\Documents\krakengaming\apps\frontend\src\app\port-battles\page.tsx`)).default;r()}catch(e){r(e)}},1)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[9769,869,3429],()=>a(2484));module.exports=r})();